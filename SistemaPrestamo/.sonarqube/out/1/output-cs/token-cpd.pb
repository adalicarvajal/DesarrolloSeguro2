¸ã
WC:\Users\USUARIO\Desktop\DesarrolloSeguro2\SistemaPrestamo\Prestamo.Data\UsuarioData.cs
	namespace		 	
Prestamo		
 
.		 
Data		 
{

 
public 

class 
UsuarioData 
{ 
private 
readonly 
ConnectionStrings *
con+ .
;. /
public 
UsuarioData 
( 
IOptions #
<# $
ConnectionStrings$ 5
>5 6
options7 >
)> ?
{ 	
con 
= 
options 
. 
Value 
;  
} 	
public 
string !
GenerarClaveAleatoria +
(+ ,
int, /
longitud0 8
)8 9
{ 	
const 
string 

caracteres #
=$ %
$str& f
;f g
var 
clave 
= 
new 
char  
[  !
longitud! )
]) *
;* +
using 
( 
var 
rng 
= 
new  $
RNGCryptoServiceProvider! 9
(9 :
): ;
); <
{ 
var 
bytes 
= 
new 
byte  $
[$ %
longitud% -
]- .
;. /
rng 
. 
GetBytes 
( 
bytes "
)" #
;# $
for 
( 
int 
i 
= 
$num 
; 
i  !
<" #
clave$ )
.) *
Length* 0
;0 1
i2 3
++3 5
)5 6
{ 
clave 
[ 
i 
] 
= 

caracteres )
[) *
bytes* /
[/ 0
i0 1
]1 2
%3 4

caracteres5 ?
.? @
Length@ F
]F G
;G H
} 
} 
Console 
. 
	WriteLine 
( 
new !
string" (
(( )
clave) .
). /
)/ 0
;0 1
return   
new   
string   
(   
clave   #
)  # $
;  $ %
}!! 	
public"" 
async"" 
Task"" 
<"" 
Usuario"" !
>""! "
ObtenerPorCorreo""# 3
(""3 4
string""4 :
correo""; A
)""A B
{## 	
Usuario$$ 
objeto$$ 
=$$ 
null$$ !
!$$! "
;$$" #
using&& 
(&& 
var&& 
conexion&& 
=&&  !
new&&" %
SqlConnection&&& 3
(&&3 4
con&&4 7
.&&7 8
	CadenaSQL&&8 A
)&&A B
)&&B C
{'' 
await(( 
conexion(( 
.(( 
	OpenAsync(( (
(((( )
)(() *
;((* +

SqlCommand)) 
cmd)) 
=))  
new))! $

SqlCommand))% /
())/ 0
$str))0 L
,))L M
conexion))N V
)))V W
;))W X
cmd** 
.** 

Parameters** 
.** 
AddWithValue** +
(**+ ,
$str**, 5
,**5 6
correo**7 =
)**= >
;**> ?
cmd++ 
.++ 
CommandType++ 
=++  !
CommandType++" -
.++- .
StoredProcedure++. =
;++= >
using-- 
(-- 
var-- 
dr-- 
=-- 
await--  %
cmd--& )
.--) *
ExecuteReaderAsync--* <
(--< =
)--= >
)--> ?
{.. 
while// 
(// 
await//  
dr//! #
.//# $
	ReadAsync//$ -
(//- .
)//. /
)/// 0
{00 
objeto11 
=11  
new11! $
Usuario11% ,
(11, -
)11- .
{22 
	IdUsuario33 %
=33& '
Convert33( /
.33/ 0
ToInt32330 7
(337 8
dr338 :
[33: ;
$str33; F
]33F G
.33G H
ToString33H P
(33P Q
)33Q R
!33R S
)33S T
,33T U
NombreCompleto44 *
=44+ ,
dr44- /
[44/ 0
$str440 @
]44@ A
.44A B
ToString44B J
(44J K
)44K L
!44L M
,44M N
Correo55 "
=55# $
dr55% '
[55' (
$str55( 0
]550 1
.551 2
ToString552 :
(55: ;
)55; <
!55< =
,55= >
Clave66 !
=66" #
dr66$ &
[66& '
$str66' .
]66. /
.66/ 0
ToString660 8
(668 9
)669 :
!66: ;
,66; <
Rol77 
=77  !
dr77" $
[77$ %
$str77% *
]77* +
.77+ ,
ToString77, 4
(774 5
)775 6
!776 7
,777 8
FailedAttempts88 *
=88+ ,
Convert88- 4
.884 5
ToInt32885 <
(88< =
dr88= ?
[88? @
$str88@ P
]88P Q
)88Q R
,88R S
IsLocked99 $
=99% &
Convert99' .
.99. /
	ToBoolean99/ 8
(998 9
dr999 ;
[99; <
$str99< F
]99F G
)99G H
,99H I

LockoutEnd:: &
=::' (
dr::) +
[::+ ,
$str::, 8
]::8 9
==::: <
DBNull::= C
.::C D
Value::D I
?::J K
null::L P
:::Q R
Convert::S Z
.::Z [

ToDateTime::[ e
(::e f
dr::f h
[::h i
$str::i u
]::u v
)::v w
,::w x
};; 
;;; 
}<< 
}== 
}>> 
return?? 
objeto?? 
;?? 
}@@ 	
publicBB 
asyncBB 
TaskBB 
<BB 
boolBB 
>BB 
CrearBB  %
(BB% &
UsuarioBB& -
usuarioBB. 5
)BB5 6
{CC 	
usingDD 
(DD 
varDD 
conexionDD 
=DD  !
newDD" %
SqlConnectionDD& 3
(DD3 4
conDD4 7
.DD7 8
	CadenaSQLDD8 A
)DDA B
)DDB C
{EE 
awaitFF 
conexionFF 
.FF 
	OpenAsyncFF (
(FF( )
)FF) *
;FF* +

SqlCommandGG 
cmdGG 
=GG  
newGG! $

SqlCommandGG% /
(GG/ 0
$strGG0 A
,GGA B
conexionGGC K
)GGK L
;GGL M
cmdHH 
.HH 

ParametersHH 
.HH 
AddWithValueHH +
(HH+ ,
$strHH, =
,HH= >
usuarioHH? F
.HHF G
NombreCompletoHHG U
)HHU V
;HHV W
cmdII 
.II 

ParametersII 
.II 
AddWithValueII +
(II+ ,
$strII, 5
,II5 6
usuarioII7 >
.II> ?
CorreoII? E
)IIE F
;IIF G
cmdJJ 
.JJ 

ParametersJJ 
.JJ 
AddWithValueJJ +
(JJ+ ,
$strJJ, 4
,JJ4 5
usuarioJJ6 =
.JJ= >
ClaveJJ> C
)JJC D
;JJD E
cmdKK 
.KK 

ParametersKK 
.KK 
AddWithValueKK +
(KK+ ,
$strKK, 2
,KK2 3
usuarioKK4 ;
.KK; <
RolKK< ?
)KK? @
;KK@ A
cmdLL 
.LL 
CommandTypeLL 
=LL  !
CommandTypeLL" -
.LL- .
StoredProcedureLL. =
;LL= >
intNN 
rowsAffectedNN  
=NN! "
awaitNN# (
cmdNN) ,
.NN, - 
ExecuteNonQueryAsyncNN- A
(NNA B
)NNB C
;NNC D
returnOO 
rowsAffectedOO #
>OO$ %
$numOO& '
;OO' (
}PP 
}QQ 	
publicSS 
asyncSS 
TaskSS 
UpdateLockoutStatusSS -
(SS- .
UsuarioSS. 5
usuarioSS6 =
)SS= >
{TT 	
usingUU 
(UU 
varUU 
conexionUU 
=UU  !
newUU" %
SqlConnectionUU& 3
(UU3 4
conUU4 7
.UU7 8
	CadenaSQLUU8 A
)UUA B
)UUB C
{VV 
awaitWW 
conexionWW 
.WW 
	OpenAsyncWW (
(WW( )
)WW) *
;WW* +

SqlCommandXX 
cmdXX 
=XX  
newXX! $

SqlCommandXX% /
(XX/ 0
$strXX0 H
,XXH I
conexionXXJ R
)XXR S
;XXS T
cmdYY 
.YY 
CommandTypeYY 
=YY  !
CommandTypeYY" -
.YY- .
StoredProcedureYY. =
;YY= >
cmdZZ 
.ZZ 

ParametersZZ 
.ZZ 
AddWithValueZZ +
(ZZ+ ,
$strZZ, 8
,ZZ8 9
usuarioZZ: A
.ZZA B
	IdUsuarioZZB K
)ZZK L
;ZZL M
cmd[[ 
.[[ 

Parameters[[ 
.[[ 
AddWithValue[[ +
([[+ ,
$str[[, =
,[[= >
usuario[[? F
.[[F G
FailedAttempts[[G U
)[[U V
;[[V W
cmd\\ 
.\\ 

Parameters\\ 
.\\ 
AddWithValue\\ +
(\\+ ,
$str\\, @
,\\@ A
usuario\\B I
.\\I J
LastFailedAttempt\\J [
)\\[ \
;\\\ ]
cmd]] 
.]] 

Parameters]] 
.]] 
AddWithValue]] +
(]]+ ,
$str]], 9
,]]9 :
usuario]]; B
.]]B C

LockoutEnd]]C M
??]]N P
(]]Q R
object]]R X
)]]X Y
DBNull]]Y _
.]]_ `
Value]]` e
)]]e f
;]]f g
cmd^^ 
.^^ 

Parameters^^ 
.^^ 
AddWithValue^^ +
(^^+ ,
$str^^, 7
,^^7 8
usuario^^9 @
.^^@ A
IsLocked^^A I
)^^I J
;^^J K
await__ 
cmd__ 
.__  
ExecuteNonQueryAsync__ .
(__. /
)__/ 0
;__0 1
}`` 
}aa 	
publiccc 
asynccc 
Taskcc 
ResetLockoutcc &
(cc& '
intcc' *
	idUsuariocc+ 4
)cc4 5
{dd 	
usingee 
(ee 
varee 
conexionee 
=ee  !
newee" %
SqlConnectionee& 3
(ee3 4
conee4 7
.ee7 8
	CadenaSQLee8 A
)eeA B
)eeB C
{ff 
awaitgg 
conexiongg 
.gg 
	OpenAsyncgg (
(gg( )
)gg) *
;gg* +

SqlCommandhh 
cmdhh 
=hh  
newhh! $

SqlCommandhh% /
(hh/ 0
$strhh0 A
,hhA B
conexionhhC K
)hhK L
;hhL M
cmdii 
.ii 
CommandTypeii 
=ii  !
CommandTypeii" -
.ii- .
StoredProcedureii. =
;ii= >
cmdjj 
.jj 

Parametersjj 
.jj 
AddWithValuejj +
(jj+ ,
$strjj, 8
,jj8 9
	idUsuariojj: C
)jjC D
;jjD E
awaitkk 
cmdkk 
.kk  
ExecuteNonQueryAsynckk .
(kk. /
)kk/ 0
;kk0 1
}ll 
}mm 	
publicoo 
asyncoo 
Taskoo 

Actualizaroo $
(oo$ %
Usuariooo% ,
usuariooo- 4
)oo4 5
{pp 	
usingqq 
(qq 
varqq 
conexionqq 
=qq  !
newqq" %
SqlConnectionqq& 3
(qq3 4
conqq4 7
.qq7 8
	CadenaSQLqq8 A
)qqA B
)qqB C
{rr 
awaitss 
conexionss 
.ss 
	OpenAsyncss (
(ss( )
)ss) *
;ss* +

SqlCommandtt 
cmdtt 
=tt  
newtt! $

SqlCommandtt% /
(tt/ 0
$strtt0 F
,ttF G
conexionttH P
)ttP Q
;ttQ R
cmduu 
.uu 

Parametersuu 
.uu 
AddWithValueuu +
(uu+ ,
$struu, 8
,uu8 9
usuariouu: A
.uuA B
	IdUsuariouuB K
)uuK L
;uuL M
cmdvv 
.vv 

Parametersvv 
.vv 
AddWithValuevv +
(vv+ ,
$strvv, 4
,vv4 5
usuariovv6 =
.vv= >
Clavevv> C
)vvC D
;vvD E
cmdww 
.ww 
CommandTypeww 
=ww  !
CommandTypeww" -
.ww- .
StoredProcedureww. =
;ww= >
awaityy 
cmdyy 
.yy  
ExecuteNonQueryAsyncyy .
(yy. /
)yy/ 0
;yy0 1
}zz 
}{{ 	
public}} 
async}} 
Task}} 
<}} 
Usuario}} !
>}}! "
ObtenerPorId}}# /
(}}/ 0
int}}0 3
	idUsuario}}4 =
)}}= >
{~~ 	
Usuario 
objeto 
= 
null !
!! "
;" #
using
ÄÄ 
(
ÄÄ 
var
ÄÄ 
conexion
ÄÄ 
=
ÄÄ  !
new
ÄÄ" %
SqlConnection
ÄÄ& 3
(
ÄÄ3 4
con
ÄÄ4 7
.
ÄÄ7 8
	CadenaSQL
ÄÄ8 A
)
ÄÄA B
)
ÄÄB C
{
ÅÅ 
await
ÇÇ 
conexion
ÇÇ 
.
ÇÇ 
	OpenAsync
ÇÇ (
(
ÇÇ( )
)
ÇÇ) *
;
ÇÇ* +

SqlCommand
ÉÉ 
cmd
ÉÉ 
=
ÉÉ  
new
ÉÉ! $

SqlCommand
ÉÉ% /
(
ÉÉ/ 0
$str
ÉÉ0 H
,
ÉÉH I
conexion
ÉÉJ R
)
ÉÉR S
;
ÉÉS T
cmd
ÑÑ 
.
ÑÑ 

Parameters
ÑÑ 
.
ÑÑ 
AddWithValue
ÑÑ +
(
ÑÑ+ ,
$str
ÑÑ, 8
,
ÑÑ8 9
	idUsuario
ÑÑ: C
)
ÑÑC D
;
ÑÑD E
cmd
ÖÖ 
.
ÖÖ 
CommandType
ÖÖ 
=
ÖÖ  !
CommandType
ÖÖ" -
.
ÖÖ- .
StoredProcedure
ÖÖ. =
;
ÖÖ= >
using
ÜÜ 
(
ÜÜ 
var
ÜÜ 
dr
ÜÜ 
=
ÜÜ 
await
ÜÜ  %
cmd
ÜÜ& )
.
ÜÜ) * 
ExecuteReaderAsync
ÜÜ* <
(
ÜÜ< =
)
ÜÜ= >
)
ÜÜ> ?
{
áá 
while
àà 
(
àà 
await
àà  
dr
àà! #
.
àà# $
	ReadAsync
àà$ -
(
àà- .
)
àà. /
)
àà/ 0
{
ââ 
objeto
ää 
=
ää  
new
ää! $
Usuario
ää% ,
(
ää, -
)
ää- .
{
ãã 
	IdUsuario
åå %
=
åå& '
Convert
åå( /
.
åå/ 0
ToInt32
åå0 7
(
åå7 8
dr
åå8 :
[
åå: ;
$str
åå; F
]
ååF G
.
ååG H
ToString
ååH P
(
ååP Q
)
ååQ R
!
ååR S
)
ååS T
,
ååT U
NombreCompleto
çç *
=
çç+ ,
dr
çç- /
[
çç/ 0
$str
çç0 @
]
çç@ A
.
ççA B
ToString
ççB J
(
ççJ K
)
ççK L
!
ççL M
,
ççM N
Correo
éé "
=
éé# $
dr
éé% '
[
éé' (
$str
éé( 0
]
éé0 1
.
éé1 2
ToString
éé2 :
(
éé: ;
)
éé; <
!
éé< =
,
éé= >
Clave
èè !
=
èè" #
dr
èè$ &
[
èè& '
$str
èè' .
]
èè. /
.
èè/ 0
ToString
èè0 8
(
èè8 9
)
èè9 :
!
èè: ;
,
èè; <
Rol
êê 
=
êê  !
dr
êê" $
[
êê$ %
$str
êê% *
]
êê* +
.
êê+ ,
ToString
êê, 4
(
êê4 5
)
êê5 6
!
êê6 7
,
êê7 8
FailedAttempts
ëë *
=
ëë+ ,
Convert
ëë- 4
.
ëë4 5
ToInt32
ëë5 <
(
ëë< =
dr
ëë= ?
[
ëë? @
$str
ëë@ P
]
ëëP Q
)
ëëQ R
,
ëëR S
IsLocked
íí $
=
íí% &
Convert
íí' .
.
íí. /
	ToBoolean
íí/ 8
(
íí8 9
dr
íí9 ;
[
íí; <
$str
íí< F
]
ííF G
)
ííG H
,
ííH I

LockoutEnd
ìì &
=
ìì' (
dr
ìì) +
[
ìì+ ,
$str
ìì, 8
]
ìì8 9
==
ìì: <
DBNull
ìì= C
.
ììC D
Value
ììD I
?
ììJ K
null
ììL P
:
ììQ R
Convert
ììS Z
.
ììZ [

ToDateTime
ìì[ e
(
ììe f
dr
ììf h
[
ììh i
$str
ììi u
]
ììu v
)
ììv w
,
ììw x
}
îî 
;
îî 
}
ïï 
}
ññ 
}
óó 
Console
òò 
.
òò 
	WriteLine
òò 
(
òò 
objeto
òò $
)
òò$ %
;
òò% &
return
ôô 
objeto
ôô 
;
ôô 
}
öö 	
}
úú 
}ùù Ÿ
WC:\Users\USUARIO\Desktop\DesarrolloSeguro2\SistemaPrestamo\Prestamo.Data\ResumenData.cs
	namespace 	
Prestamo
 
. 
Data 
{ 
public 

class 
ResumenData 
{ 
private		 
readonly		 
ConnectionStrings		 *
con		+ .
;		. /
public

 
ResumenData

 
(

 
IOptions

 #
<

# $
ConnectionStrings

$ 5
>

5 6
options

7 >
)

> ?
{ 	
con 
= 
options 
. 
Value 
;  
} 	
public 
async 
Task 
< 
Resumen !
>! "
Obtener# *
(* +
)+ ,
{ 	
Resumen 
objeto 
= 
new  
Resumen! (
(( )
)) *
;* +
using 
( 
var 
conexion 
=  !
new" %
SqlConnection& 3
(3 4
con4 7
.7 8
	CadenaSQL8 A
)A B
)B C
{ 
await 
conexion 
. 
	OpenAsync (
(( )
)) *
;* +

SqlCommand 
cmd 
=  
new! $

SqlCommand% /
(/ 0
$str0 C
,C D
conexionE M
)M N
;N O
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
using 
( 
var 
dr 
= 
await  %
cmd& )
.) *
ExecuteReaderAsync* <
(< =
)= >
)> ?
{ 
while 
( 
await  
dr! #
.# $
	ReadAsync$ -
(- .
). /
)/ 0
{ 
objeto 
=  
new! $
Resumen% ,
(, -
)- .
{ 
TotalClientes )
=* +
dr, .
[. /
$str/ >
]> ?
.? @
ToString@ H
(H I
)I J
!J K
,K L
PrestamosPendientes   /
=  0 1
dr  2 4
[  4 5
$str  5 J
]  J K
.  K L
ToString  L T
(  T U
)  U V
!  V W
,  W X
PrestamosCancelados!! /
=!!0 1
dr!!2 4
[!!4 5
$str!!5 J
]!!J K
.!!K L
ToString!!L T
(!!T U
)!!U V
!!!V W
,!!W X
InteresAcumulado"" ,
=""- .
dr""/ 1
[""1 2
$str""2 D
]""D E
.""E F
ToString""F N
(""N O
)""O P
!""P Q
,""Q R!
SolicitudesPendientes## 1
=##2 3
dr##4 6
[##6 7
$str##7 N
]##N O
.##O P
ToString##P X
(##X Y
)##Y Z
!##Z [
}$$ 
;$$ 
}%% 
}&& 
}'' 
return(( 
objeto(( 
;(( 
})) 	
},, 
}-- ü
_C:\Users\USUARIO\Desktop\DesarrolloSeguro2\SistemaPrestamo\Prestamo.Data\ResumenClienteData .cs
	namespace 	
Prestamo
 
. 
Data 
{ 
public 

class 
ResumenClienteData #
{ 
private		 
readonly		 
ConnectionStrings		 *
con		+ .
;		. /
public

 
ResumenClienteData

 !
(

! "
IOptions

" *
<

* +
ConnectionStrings

+ <
>

< =
options

> E
)

E F
{ 	
con 
= 
options 
. 
Value 
;  
} 	
public 
async 
Task 
< 
ResumenCliente (
>( )
ObtenerResumen* 8
(8 9
int9 <
	idCliente= F
,F G
intH K

idPrestamoL V
)V W
{ 	
ResumenCliente 
objeto !
=" #
new$ '
ResumenCliente( 6
(6 7
)7 8
;8 9
using 
( 
var 
conexion 
=  !
new" %
SqlConnection& 3
(3 4
con4 7
.7 8
	CadenaSQL8 A
)A B
)B C
{ 
await 
conexion 
. 
	OpenAsync (
(( )
)) *
;* +

SqlCommand 
cmd 
=  
new! $

SqlCommand% /
(/ 0
$str0 M
,M N
conexionO W
)W X
;X Y
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 8
,8 9
	idCliente: C
)C D
;D E
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 9
,9 :

idPrestamo; E
)E F
;F G
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
using 
( 
var 
dr 
= 
await  %
cmd& )
.) *
ExecuteReaderAsync* <
(< =
)= >
)> ?
{ 
if 
( 
await 
dr  
.  !
	ReadAsync! *
(* +
)+ ,
), -
{ 
objeto 
=  
new! $
ResumenCliente% 3
(3 4
)4 5
{   
PrestamosCliente!! ,
=!!- .
dr!!/ 1
[!!1 2
$str!!2 G
]!!G H
.!!H I
ToString!!I Q
(!!Q R
)!!R S
!!!S T
,!!T U"
PagosClientePendientes"" 2
=""3 4
dr""5 7
[""7 8
$str""8 J
]""J K
.""K L
ToString""L T
(""T U
)""U V
!""V W
,""W X
}## 
;## 
}$$ 
}%% 
}&& 
return'' 
objeto'' 
;'' 
}(( 	
}** 
}++ À‚
XC:\Users\USUARIO\Desktop\DesarrolloSeguro2\SistemaPrestamo\Prestamo.Data\PrestamoData.cs
	namespace		 	
Prestamo		
 
.		 
Data		 
{

 
public 

class 
PrestamoData 
{ 
private 
readonly 
ConnectionStrings *
con+ .
;. /
public 
PrestamoData 
( 
IOptions $
<$ %
ConnectionStrings% 6
>6 7
options8 ?
)? @
{ 	
con 
= 
options 
. 
Value 
;  
} 	
public 
async 
Task 
< 
int 
> '
ObtenerIdPrestamoPorCliente :
(: ;
int; >
	idCliente? H
)H I
{ 	
int 

idPrestamo 
= 
$num 
; 
using 
( 
var 
conexion 
=  !
new" %
SqlConnection& 3
(3 4
con4 7
.7 8
	CadenaSQL8 A
)A B
)B C
{ 
await 
conexion 
. 
	OpenAsync (
(( )
)) *
;* +

SqlCommand 
cmd 
=  
new! $

SqlCommand% /
(/ 0
$str0 P
,P Q
conexionR Z
)Z [
;[ \
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 8
,8 9
	idCliente: C
)C D
;D E
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
using 
( 
var 
dr 
= 
await  %
cmd& )
.) *
ExecuteReaderAsync* <
(< =
)= >
)> ?
{ 
if   
(   
await   
dr    
.    !
	ReadAsync  ! *
(  * +
)  + ,
)  , -
{!! 

idPrestamo"" "
=""# $
Convert""% ,
."", -
ToInt32""- 4
(""4 5
dr""5 7
[""7 8
$str""8 D
]""D E
)""E F
;""F G
}## 
}$$ 
}%% 
return&& 

idPrestamo&& 
;&& 
}'' 	
public)) 
async)) 
Task)) 
<)) 
string))  
>))  !
Crear))" '
())' (
Prestamo))( 0
.))0 1
	Entidades))1 :
.)): ;
Prestamo)); C
objeto))D J
)))J K
{** 	
string,, 
	respuesta,, 
=,, 
$str,, !
;,,! "
using-- 
(-- 
var-- 
conexion-- 
=--  !
new--" %
SqlConnection--& 3
(--3 4
con--4 7
.--7 8
	CadenaSQL--8 A
)--A B
)--B C
{.. 
await// 
conexion// 
.// 
	OpenAsync// (
(//( )
)//) *
;//* +

SqlCommand00 
cmd00 
=00  
new00! $

SqlCommand00% /
(00/ 0
$str000 B
,00B C
conexion00D L
)00L M
;00M N
cmd11 
.11 

Parameters11 
.11 
AddWithValue11 +
(11+ ,
$str11, 8
,118 9
objeto11: @
.11@ A
Cliente11A H
.11H I
	IdCliente11I R
)11R S
;11S T
cmd22 
.22 

Parameters22 
.22 
AddWithValue22 +
(22+ ,
$str22, ;
,22; <
objeto22= C
.22C D
Cliente22D K
.22K L
NroDocumento22L X
)22X Y
;22Y Z
cmd33 
.33 

Parameters33 
.33 
AddWithValue33 +
(33+ ,
$str33, 5
,335 6
objeto337 =
.33= >
Cliente33> E
.33E F
Nombre33F L
)33L M
;33M N
cmd44 
.44 

Parameters44 
.44 
AddWithValue44 +
(44+ ,
$str44, 7
,447 8
objeto449 ?
.44? @
Cliente44@ G
.44G H
Apellido44H P
)44P Q
;44Q R
cmd55 
.55 

Parameters55 
.55 
AddWithValue55 +
(55+ ,
$str55, 5
,555 6
objeto557 =
.55= >
Cliente55> E
.55E F
Correo55F L
)55L M
;55M N
cmd66 
.66 

Parameters66 
.66 
AddWithValue66 +
(66+ ,
$str66, 7
,667 8
objeto669 ?
.66? @
Cliente66@ G
.66G H
Telefono66H P
)66P Q
;66Q R
cmd77 
.77 

Parameters77 
.77 
AddWithValue77 +
(77+ ,
$str77, 7
,777 8
objeto779 ?
.77? @
Moneda77@ F
.77F G
IdMoneda77G O
)77O P
;77P Q
cmd88 
.88 

Parameters88 
.88 
AddWithValue88 +
(88+ ,
$str88, :
,88: ;
objeto88< B
.88B C
FechaInicioPago88C R
)88R S
;88S T
cmd99 
.99 

Parameters99 
.99 
AddWithValue99 +
(99+ ,
$str99, <
,99< =
objeto99> D
.99D E
MontoPrestamo99E R
)99R S
;99S T
cmd:: 
.:: 

Parameters:: 
.:: 
AddWithValue:: +
(::+ ,
$str::, @
,::@ A
objeto::B H
.::H I
InteresPorcentaje::I Z
)::Z [
;::[ \
cmd;; 
.;; 

Parameters;; 
.;; 
AddWithValue;; +
(;;+ ,
$str;;, 8
,;;8 9
objeto;;: @
.;;@ A
	NroCuotas;;A J
);;J K
;;;K L
cmd<< 
.<< 

Parameters<< 
.<< 
AddWithValue<< +
(<<+ ,
$str<<, :
,<<: ;
objeto<<< B
.<<B C
FormaDePago<<C N
)<<N O
;<<O P
cmd== 
.== 

Parameters== 
.== 
AddWithValue== +
(==+ ,
$str==, <
,==< =
objeto==> D
.==D E
ValorPorCuota==E R
)==R S
;==S T
cmd>> 
.>> 

Parameters>> 
.>> 
AddWithValue>> +
(>>+ ,
$str>>, ;
,>>; <
objeto>>= C
.>>C D
ValorInteres>>D P
)>>P Q
;>>Q R
cmd?? 
.?? 

Parameters?? 
.?? 
AddWithValue?? +
(??+ ,
$str??, 9
,??9 :
objeto??; A
.??A B

ValorTotal??B L
)??L M
;??M N
cmd@@ 
.@@ 

Parameters@@ 
.@@ 
Add@@ "
(@@" #
$str@@# .
,@@. /
	SqlDbType@@0 9
.@@9 :
VarChar@@: A
,@@A B
$num@@C F
)@@F G
.@@G H
	Direction@@H Q
=@@R S
ParameterDirection@@T f
.@@f g
Output@@g m
;@@m n
cmdAA 
.AA 
CommandTypeAA 
=AA  !
CommandTypeAA" -
.AA- .
StoredProcedureAA. =
;AA= >
tryCC 
{DD 
awaitEE 
cmdEE 
.EE  
ExecuteNonQueryAsyncEE 2
(EE2 3
)EE3 4
;EE4 5
	respuestaFF 
=FF 
ConvertFF  '
.FF' (
ToStringFF( 0
(FF0 1
cmdFF1 4
.FF4 5

ParametersFF5 ?
[FF? @
$strFF@ K
]FFK L
.FFL M
ValueFFM R
)FFR S
!FFS T
;FFT U
}GG 
catchHH 
{II 
	respuestaJJ 
=JJ 
$strJJ  3
;JJ3 4
}KK 
}LL 
returnMM 
	respuestaMM 
;MM 
}NN 	
publicPP 
asyncPP 
TaskPP 
<PP 
ListPP 
<PP 
PrestamoPP '
.PP' (
	EntidadesPP( 1
.PP1 2
PrestamoPP2 :
>PP: ;
>PP; <
ObtenerPrestamosPP= M
(PPM N
intPPN Q
IdPPR T
,PPT U
stringPPV \
NroDocumentoPP] i
)PPi j
{QQ 	
ListRR 
<RR 
PrestamoRR 
.RR 
	EntidadesRR #
.RR# $
PrestamoRR$ ,
>RR, -
listaRR. 3
=RR4 5
newRR6 9
ListRR: >
<RR> ?
PrestamoRR? G
.RRG H
	EntidadesRRH Q
.RRQ R
PrestamoRRR Z
>RRZ [
(RR[ \
)RR\ ]
;RR] ^
usingTT 
(TT 
varTT 
conexionTT 
=TT  !
newTT" %
SqlConnectionTT& 3
(TT3 4
conTT4 7
.TT7 8
	CadenaSQLTT8 A
)TTA B
)TTB C
{UU 
awaitVV 
conexionVV 
.VV 
	OpenAsyncVV (
(VV( )
)VV) *
;VV* +

SqlCommandWW 
cmdWW 
=WW  
newWW! $

SqlCommandWW% /
(WW/ 0
$strWW0 E
,WWE F
conexionWWG O
)WWO P
;WWP Q
cmdXX 
.XX 

ParametersXX 
.XX 
AddWithValueXX +
(XX+ ,
$strXX, 9
,XX9 :
IdXX; =
)XX= >
;XX> ?
cmdYY 
.YY 

ParametersYY 
.YY 
AddWithValueYY +
(YY+ ,
$strYY, ;
,YY; <
NroDocumentoYY= I
)YYI J
;YYJ K
cmdZZ 
.ZZ 
CommandTypeZZ 
=ZZ  !
CommandTypeZZ" -
.ZZ- .
StoredProcedureZZ. =
;ZZ= >
using\\ 
(\\ 
var\\ 
dr\\ 
=\\ 
await\\  %
cmd\\& )
.\\) *!
ExecuteXmlReaderAsync\\* ?
(\\? @
)\\@ A
)\\A B
{]] 
if^^ 
(^^ 
await^^ 
dr^^  
.^^  !
	ReadAsync^^! *
(^^* +
)^^+ ,
)^^, -
{__ 
	XDocument`` !
doc``" %
=``& '
	XDocument``( 1
.``1 2
Load``2 6
(``6 7
dr``7 9
)``9 :
;``: ;
listaaa 
=aa 
(aa  !
(aa! "
docaa" %
.aa% &
Elementsaa& .
(aa. /
$straa/ :
)aa: ;
)aa; <
!=aa= ?
nullaa@ D
)aaD E
?aaF G
(aaH I
fromaaI M
prestamoaaN V
inaaW Y
docaaZ ]
.aa] ^
Elementaa^ e
(aae f
$straaf q
)aaq r
!aar s
.aas t
Elementsaat |
(aa| }
$str	aa} á
)
aaá à
selectbbM S
newbbT W
PrestamobbX `
.bb` a
	Entidadesbba j
.bbj k
Prestamobbk s
(bbs t
)bbt u
{ccM N

IdPrestamoddQ [
=dd\ ]
Convertdd^ e
.dde f
ToInt32ddf m
(ddm n
prestamoddn v
.ddv w
Elementddw ~
(dd~ 
$str	dd ã
)
ddã å
!
ddå ç
.
ddç é
Value
ddé ì
)
ddì î
,
ddî ï
ClienteeeQ X
=eeY Z
newee[ ^
Clienteee_ f
(eef g
)eeg h
{ffQ R
	IdClienteggU ^
=gg_ `
Convertgga h
.ggh i
ToInt32ggi p
(ggp q
prestamoggq y
.ggy z
Element	ggz Å
(
ggÅ Ç
$str
ggÇ ç
)
ggç é
!
ggé è
.
ggè ê
Value
ggê ï
)
ggï ñ
,
ggñ ó
NroDocumentohhU a
=hhb c
prestamohhd l
.hhl m
Elementhhm t
(hht u
$str	hhu É
)
hhÉ Ñ
!
hhÑ Ö
.
hhÖ Ü
Value
hhÜ ã
,
hhã å
NombreiiU [
=ii\ ]
prestamoii^ f
.iif g
Elementiig n
(iin o
$striio w
)iiw x
!iix y
.iiy z
Valueiiz 
,	ii Ä
ApellidojjU ]
=jj^ _
prestamojj` h
.jjh i
Elementjji p
(jjp q
$strjjq {
)jj{ |
!jj| }
.jj} ~
Value	jj~ É
,
jjÉ Ñ
CorreokkU [
=kk\ ]
prestamokk^ f
.kkf g
Elementkkg n
(kkn o
$strkko w
)kkw x
!kkx y
.kky z
Valuekkz 
,	kk Ä
TelefonollU ]
=ll^ _
prestamoll` h
.llh i
Elementlli p
(llp q
$strllq {
)ll{ |
!ll| }
.ll} ~
Value	ll~ É
}mmQ R
,mmR S
MonedannQ W
=nnX Y
newnnZ ]
Monedann^ d
{ooQ R
IdMonedappU ]
=pp^ _
Convertpp` g
.ppg h
ToInt32pph o
(ppo p
prestamoppp x
.ppx y
Element	ppy Ä
(
ppÄ Å
$str
ppÅ ã
)
ppã å
!
ppå ç
.
ppç é
Value
ppé ì
)
ppì î
,
ppî ï
NombreqqU [
=qq\ ]
prestamoqq^ f
.qqf g
Elementqqg n
(qqn o
$strqqo }
)qq} ~
!qq~ 
.	qq Ä
Value
qqÄ Ö
,
qqÖ Ü
SimbolorrU \
=rr] ^
prestamorr_ g
.rrg h
Elementrrh o
(rro p
$strrrp y
)rry z
!rrz {
.rr{ |
Value	rr| Å
}ssQ R
,ssR S
FechaInicioPagottQ `
=tta b
prestamottc k
.ttk l
Elementttl s
(tts t
$str	ttt Ö
)
ttÖ Ü
!
ttÜ á
.
ttá à
Value
ttà ç
,
ttç é
MontoPrestamouuQ ^
=uu_ `
prestamouua i
.uui j
Elementuuj q
(uuq r
$str	uur Å
)
uuÅ Ç
!
uuÇ É
.
uuÉ Ñ
Value
uuÑ â
,
uuâ ä
InteresPorcentajevvQ b
=vvc d
prestamovve m
.vvm n
Elementvvn u
(vvu v
$str	vvv â
)
vvâ ä
!
vvä ã
.
vvã å
Value
vvå ë
,
vvë í
	NroCuotaswwQ Z
=ww[ \
Convertww] d
.wwd e
ToInt32wwe l
(wwl m
prestamowwm u
.wwu v
Elementwwv }
(ww} ~
$str	ww~ â
)
wwâ ä
!
wwä ã
.
wwã å
Value
wwå ë
)
wwë í
,
wwí ì
FormaDePagoxxQ \
=xx] ^
prestamoxx_ g
.xxg h
Elementxxh o
(xxo p
$strxxp }
)xx} ~
!xx~ 
.	xx Ä
Value
xxÄ Ö
,
xxÖ Ü
ValorPorCuotayyQ ^
=yy_ `
prestamoyya i
.yyi j
Elementyyj q
(yyq r
$str	yyr Å
)
yyÅ Ç
!
yyÇ É
.
yyÉ Ñ
Value
yyÑ â
,
yyâ ä
ValorIntereszzQ ]
=zz^ _
prestamozz` h
.zzh i
Elementzzi p
(zzp q
$strzzq 
)	zz Ä
!
zzÄ Å
.
zzÅ Ç
Value
zzÇ á
,
zzá à

ValorTotal{{Q [
={{\ ]
prestamo{{^ f
.{{f g
Element{{g n
({{n o
$str{{o {
){{{ |
!{{| }
.{{} ~
Value	{{~ É
,
{{É Ñ
Estado||Q W
=||X Y
prestamo||Z b
.||b c
Element||c j
(||j k
$str||k s
)||s t
!||t u
.||u v
Value||v {
,||{ |
FechaCreacion}}Q ^
=}}_ `
prestamo}}a i
.}}i j
Element}}j q
(}}q r
$str	}}r Å
)
}}Å Ç
!
}}Ç É
.
}}É Ñ
Value
}}Ñ â
,
}}â ä
PrestamoDetalle~~Q `
=~~a b
prestamo~~c k
.~~k l
Elements~~l t
(~~t u
$str	~~u Ü
)
~~Ü á
!=
~~à ä
null
~~ã è
?
~~ê ë
(
~~í ì
from
~~ì ó
detalle
~~ò ü
in
~~† ¢
prestamo
~~£ ´
.
~~´ ¨
Element
~~¨ ≥
(
~~≥ ¥
$str
~~¥ ≈
)
~~≈ ∆
!
~~∆ «
.
~~« »
Elements
~~» –
(
~~– —
$str
~~— ⁄
)
~~⁄ €
select
å í
new
ì ñ
PrestamoDetalle
ó ¶
(
¶ ß
)
ß ®
{ÄÄå ç!
IdPrestamoDetalleÅÅê °
=ÅÅ¢ £
ConvertÅÅ§ ´
.ÅÅ´ ¨
ToInt32ÅÅ¨ ≥
(ÅÅ≥ ¥
detalleÅÅ¥ ª
.ÅÅª º
ElementÅÅº √
(ÅÅ√ ƒ
$strÅÅƒ ◊
)ÅÅ◊ ÿ
!ÅÅÿ Ÿ
.ÅÅŸ ⁄
ValueÅÅ⁄ ﬂ
)ÅÅﬂ ‡
,ÅÅ‡ ·
	FechaPagoÇÇê ô
=ÇÇö õ
detalleÇÇú £
.ÇÇ£ §
ElementÇÇ§ ´
(ÇÇ´ ¨
$strÇÇ¨ ∑
)ÇÇ∑ ∏
!ÇÇ∏ π
.ÇÇπ ∫
ValueÇÇ∫ ø
,ÇÇø ¿

MontoCuotaÉÉê ö
=ÉÉõ ú
detalleÉÉù §
.ÉÉ§ •
ElementÉÉ• ¨
(ÉÉ¨ ≠
$strÉÉ≠ π
)ÉÉπ ∫
!ÉÉ∫ ª
.ÉÉª º
ValueÉÉº ¡
,ÉÉ¡ ¬
NroCuotaÑÑê ò
=ÑÑô ö
ConvertÑÑõ ¢
.ÑÑ¢ £
ToInt32ÑÑ£ ™
(ÑÑ™ ´
detalleÑÑ´ ≤
.ÑÑ≤ ≥
ElementÑÑ≥ ∫
(ÑÑ∫ ª
$strÑÑª ≈
)ÑÑ≈ ∆
!ÑÑ∆ «
.ÑÑ« »
ValueÑÑ» Õ
)ÑÑÕ Œ
,ÑÑŒ œ
EstadoÖÖê ñ
=ÖÖó ò
detalleÖÖô †
.ÖÖ† °
ElementÖÖ° ®
(ÖÖ® ©
$strÖÖ© ±
)ÖÖ± ≤
!ÖÖ≤ ≥
.ÖÖ≥ ¥
ValueÖÖ¥ π
,ÖÖπ ∫
FechaPagadoÜÜê õ
=ÜÜú ù
detalleÜÜû •
.ÜÜ• ¶
ElementÜÜ¶ ≠
(ÜÜ≠ Æ
$strÜÜÆ ª
)ÜÜª º
!ÜÜº Ω
.ÜÜΩ æ
ValueÜÜæ √
}ááå ç
)ááç é
.ááé è
ToListááè ï
(ááï ñ
)ááñ ó
:ááò ô
newááö ù
Listááû ¢
<áá¢ £
PrestamoDetalleáá£ ≤
>áá≤ ≥
(áá≥ ¥
)áá¥ µ
}
ââM N
)
ââN O
.
ââO P
ToList
ââP V
(
ââV W
)
ââW X
:
ââY Z
new
ââ[ ^
List
ââ_ c
<
ââc d
Prestamo
ââd l
.
ââl m
	Entidades
ââm v
.
ââv w
Prestamo
ââw 
>ââ Ä
(ââÄ Å
)ââÅ Ç
;ââÇ É
}
ãã 
}
åå 
}
çç 
return
éé 
lista
éé 
;
éé 
}
èè 	
public
ëë 
async
ëë 
Task
ëë 
<
ëë 
string
ëë  
>
ëë  !
PagarCuotas
ëë" -
(
ëë- .
int
ëë. 1

IdPrestamo
ëë2 <
,
ëë< =
string
ëë> D
NroCuotasPagadas
ëëE U
,
ëëU V
string
ëëW ]
NumeroTarjeta
ëë^ k
)
ëëk l
{
íí 	
string
ìì 
	respuesta
ìì 
=
ìì 
$str
ìì !
;
ìì! "
using
îî 
(
îî 
var
îî 
conexion
îî 
=
îî  !
new
îî" %
SqlConnection
îî& 3
(
îî3 4
con
îî4 7
.
îî7 8
	CadenaSQL
îî8 A
)
îîA B
)
îîB C
{
ïï 
await
ññ 
conexion
ññ 
.
ññ 
	OpenAsync
ññ (
(
ññ( )
)
ññ) *
;
ññ* +

SqlCommand
óó 
cmd
óó 
=
óó  
new
óó! $

SqlCommand
óó% /
(
óó/ 0
$str
óó0 @
,
óó@ A
conexion
óóB J
)
óóJ K
;
óóK L
cmd
òò 
.
òò 

Parameters
òò 
.
òò 
AddWithValue
òò +
(
òò+ ,
$str
òò, 9
,
òò9 :

IdPrestamo
òò; E
)
òòE F
;
òòF G
cmd
ôô 
.
ôô 

Parameters
ôô 
.
ôô 
AddWithValue
ôô +
(
ôô+ ,
$str
ôô, ?
,
ôô? @
NroCuotasPagadas
ôôA Q
)
ôôQ R
;
ôôR S
cmd
öö 
.
öö 

Parameters
öö 
.
öö 
AddWithValue
öö +
(
öö+ ,
$str
öö, <
,
öö< =
NumeroTarjeta
öö> K
)
ööK L
;
ööL M
cmd
õõ 
.
õõ 

Parameters
õõ 
.
õõ 
Add
õõ "
(
õõ" #
$str
õõ# .
,
õõ. /
	SqlDbType
õõ0 9
.
õõ9 :
VarChar
õõ: A
,
õõA B
$num
õõC F
)
õõF G
.
õõG H
	Direction
õõH Q
=
õõR S 
ParameterDirection
õõT f
.
õõf g
Output
õõg m
;
õõm n
cmd
úú 
.
úú 
CommandType
úú 
=
úú  !
CommandType
úú" -
.
úú- .
StoredProcedure
úú. =
;
úú= >
try
ûû 
{
üü 
await
†† 
cmd
†† 
.
†† "
ExecuteNonQueryAsync
†† 2
(
††2 3
)
††3 4
;
††4 5
	respuesta
°° 
=
°° 
Convert
°°  '
.
°°' (
ToString
°°( 0
(
°°0 1
cmd
°°1 4
.
°°4 5

Parameters
°°5 ?
[
°°? @
$str
°°@ K
]
°°K L
.
°°L M
Value
°°M R
)
°°R S
!
°°S T
;
°°T U
}
¢¢ 
catch
££ 
(
££ 
	Exception
££  
ex
££! #
)
££# $
{
§§ 
	respuesta
•• 
=
•• 
$str
••  5
+
••6 7
ex
••8 :
.
••: ;
Message
••; B
;
••B C
}
¶¶ 
}
ßß 
return
®® 
	respuesta
®® 
;
®® 
}
©© 	
public
´´ 
async
´´ 
Task
´´ 
<
´´ 
bool
´´ 
>
´´ $
CrearSolicitudPrestamo
´´  6
(
´´6 7
SolicitudPrestamo
´´7 H
	solicitud
´´I R
)
´´R S
{
¨¨ 	
using
≠≠ 
(
≠≠ 
var
≠≠ 
conexion
≠≠ 
=
≠≠  !
new
≠≠" %
SqlConnection
≠≠& 3
(
≠≠3 4
con
≠≠4 7
.
≠≠7 8
	CadenaSQL
≠≠8 A
)
≠≠A B
)
≠≠B C
{
ÆÆ 
await
ØØ 
conexion
ØØ 
.
ØØ 
	OpenAsync
ØØ (
(
ØØ( )
)
ØØ) *
;
ØØ* +

SqlCommand
∞∞ 
cmd
∞∞ 
=
∞∞  
new
∞∞! $

SqlCommand
∞∞% /
(
∞∞/ 0
$str
∞∞0 K
,
∞∞K L
conexion
∞∞M U
)
∞∞U V
;
∞∞V W
cmd
±± 
.
±± 

Parameters
±± 
.
±± 
AddWithValue
±± +
(
±±+ ,
$str
±±, 8
,
±±8 9
	solicitud
±±: C
.
±±C D
	IdUsuario
±±D M
)
±±M N
;
±±N O
cmd
≤≤ 
.
≤≤ 

Parameters
≤≤ 
.
≤≤ 
AddWithValue
≤≤ +
(
≤≤+ ,
$str
≤≤, 4
,
≤≤4 5
	solicitud
≤≤6 ?
.
≤≤? @
Monto
≤≤@ E
)
≤≤E F
;
≤≤F G
cmd
≥≥ 
.
≥≥ 

Parameters
≥≥ 
.
≥≥ 
AddWithValue
≥≥ +
(
≥≥+ ,
$str
≥≥, 4
,
≥≥4 5
	solicitud
≥≥6 ?
.
≥≥? @
Plazo
≥≥@ E
)
≥≥E F
;
≥≥F G
cmd
¥¥ 
.
¥¥ 

Parameters
¥¥ 
.
¥¥ 
AddWithValue
¥¥ +
(
¥¥+ ,
$str
¥¥, 5
,
¥¥5 6
	solicitud
¥¥7 @
.
¥¥@ A
Estado
¥¥A G
)
¥¥G H
;
¥¥H I
cmd
µµ 
.
µµ 

Parameters
µµ 
.
µµ 
AddWithValue
µµ +
(
µµ+ ,
$str
µµ, =
,
µµ= >
	solicitud
µµ? H
.
µµH I
FechaSolicitud
µµI W
)
µµW X
;
µµX Y
cmd
∂∂ 
.
∂∂ 

Parameters
∂∂ 
.
∂∂ 
AddWithValue
∂∂ +
(
∂∂+ ,
$str
∂∂, 5
,
∂∂5 6
	solicitud
∂∂7 @
.
∂∂@ A
Sueldo
∂∂A G
)
∂∂G H
;
∂∂H I
cmd
∑∑ 
.
∑∑ 

Parameters
∑∑ 
.
∑∑ 
AddWithValue
∑∑ +
(
∑∑+ ,
$str
∑∑, 7
,
∑∑7 8
	solicitud
∑∑9 B
.
∑∑B C
EsCasado
∑∑C K
)
∑∑K L
;
∑∑L M
cmd
∏∏ 
.
∏∏ 

Parameters
∏∏ 
.
∏∏ 
AddWithValue
∏∏ +
(
∏∏+ ,
$str
∏∏, :
,
∏∏: ;
	solicitud
∏∏< E
.
∏∏E F
NumeroHijos
∏∏F Q
)
∏∏Q R
;
∏∏R S
cmd
ππ 
.
ππ 

Parameters
ππ 
.
ππ 
AddWithValue
ππ +
(
ππ+ ,
$str
ππ, 9
,
ππ9 :
	solicitud
ππ; D
.
ππD E

MetodoPago
ππE O
)
ππO P
;
ππP Q
cmd
∫∫ 
.
∫∫ 

Parameters
∫∫ 
.
∫∫ 
AddWithValue
∫∫ +
(
∫∫+ ,
$str
∫∫, 5
,
∫∫5 6
	solicitud
∫∫7 @
.
∫∫@ A
Cedula
∫∫A G
)
∫∫G H
;
∫∫H I
cmd
ªª 
.
ªª 

Parameters
ªª 
.
ªª 
AddWithValue
ªª +
(
ªª+ ,
$str
ªª, 8
,
ªª8 9
	solicitud
ªª: C
.
ªªC D
	Ocupacion
ªªD M
)
ªªM N
;
ªªN O
cmd
ºº 
.
ºº 
CommandType
ºº 
=
ºº  !
CommandType
ºº" -
.
ºº- .
StoredProcedure
ºº. =
;
ºº= >
int
ææ 
rowsAffected
ææ  
=
ææ! "
await
ææ# (
cmd
ææ) ,
.
ææ, -"
ExecuteNonQueryAsync
ææ- A
(
ææA B
)
ææB C
;
ææC D
return
øø 
rowsAffected
øø #
>
øø$ %
$num
øø& '
;
øø' (
}
¿¿ 
}
¡¡ 	
public
√√ 
async
√√ 
Task
√√ 
<
√√ 
List
√√ 
<
√√ 
SolicitudPrestamo
√√ 0
>
√√0 1
>
√√1 2*
ObtenerSolicitudesPendientes
√√3 O
(
√√O P
)
√√P Q
{
ƒƒ 	
List
≈≈ 
<
≈≈ 
SolicitudPrestamo
≈≈ "
>
≈≈" #
solicitudes
≈≈$ /
=
≈≈0 1
new
≈≈2 5
List
≈≈6 :
<
≈≈: ;
SolicitudPrestamo
≈≈; L
>
≈≈L M
(
≈≈M N
)
≈≈N O
;
≈≈O P
using
«« 
(
«« 
var
«« 
conexion
«« 
=
««  !
new
««" %
SqlConnection
««& 3
(
««3 4
con
««4 7
.
««7 8
	CadenaSQL
««8 A
)
««A B
)
««B C
{
»» 
await
…… 
conexion
…… 
.
…… 
	OpenAsync
…… (
(
……( )
)
……) *
;
……* +

SqlCommand
   
cmd
   
=
    
new
  ! $

SqlCommand
  % /
(
  / 0
$str
  0 Q
,
  Q R
conexion
  S [
)
  [ \
;
  \ ]
cmd
ÀÀ 
.
ÀÀ 
CommandType
ÀÀ 
=
ÀÀ  !
CommandType
ÀÀ" -
.
ÀÀ- .
StoredProcedure
ÀÀ. =
;
ÀÀ= >
using
ÕÕ 
(
ÕÕ 
var
ÕÕ 
dr
ÕÕ 
=
ÕÕ 
await
ÕÕ  %
cmd
ÕÕ& )
.
ÕÕ) * 
ExecuteReaderAsync
ÕÕ* <
(
ÕÕ< =
)
ÕÕ= >
)
ÕÕ> ?
{
ŒŒ 
while
œœ 
(
œœ 
await
œœ  
dr
œœ! #
.
œœ# $
	ReadAsync
œœ$ -
(
œœ- .
)
œœ. /
)
œœ/ 0
{
–– 
solicitudes
—— #
.
——# $
Add
——$ '
(
——' (
new
——( +
SolicitudPrestamo
——, =
{
““ 
Id
”” 
=
””  
Convert
””! (
.
””( )
ToInt32
””) 0
(
””0 1
dr
””1 3
[
””3 4
$str
””4 8
]
””8 9
)
””9 :
,
””: ;
	IdUsuario
‘‘ %
=
‘‘& '
Convert
‘‘( /
.
‘‘/ 0
ToInt32
‘‘0 7
(
‘‘7 8
dr
‘‘8 :
[
‘‘: ;
$str
‘‘; F
]
‘‘F G
)
‘‘G H
,
‘‘H I
Monto
’’ !
=
’’" #
Convert
’’$ +
.
’’+ ,
	ToDecimal
’’, 5
(
’’5 6
dr
’’6 8
[
’’8 9
$str
’’9 @
]
’’@ A
)
’’A B
,
’’B C
Plazo
÷÷ !
=
÷÷" #
Convert
÷÷$ +
.
÷÷+ ,
ToInt32
÷÷, 3
(
÷÷3 4
dr
÷÷4 6
[
÷÷6 7
$str
÷÷7 >
]
÷÷> ?
)
÷÷? @
,
÷÷@ A
Estado
◊◊ "
=
◊◊# $
dr
◊◊% '
[
◊◊' (
$str
◊◊( 0
]
◊◊0 1
.
◊◊1 2
ToString
◊◊2 :
(
◊◊: ;
)
◊◊; <
,
◊◊< =
FechaSolicitud
ÿÿ *
=
ÿÿ+ ,
Convert
ÿÿ- 4
.
ÿÿ4 5

ToDateTime
ÿÿ5 ?
(
ÿÿ? @
dr
ÿÿ@ B
[
ÿÿB C
$str
ÿÿC S
]
ÿÿS T
)
ÿÿT U
,
ÿÿU V
Sueldo
ŸŸ "
=
ŸŸ# $
Convert
ŸŸ% ,
.
ŸŸ, -
	ToDecimal
ŸŸ- 6
(
ŸŸ6 7
dr
ŸŸ7 9
[
ŸŸ9 :
$str
ŸŸ: B
]
ŸŸB C
)
ŸŸC D
,
ŸŸD E
EsCasado
⁄⁄ $
=
⁄⁄% &
Convert
⁄⁄' .
.
⁄⁄. /
	ToBoolean
⁄⁄/ 8
(
⁄⁄8 9
dr
⁄⁄9 ;
[
⁄⁄; <
$str
⁄⁄< F
]
⁄⁄F G
)
⁄⁄G H
,
⁄⁄H I
NumeroHijos
€€ '
=
€€( )
Convert
€€* 1
.
€€1 2
ToInt32
€€2 9
(
€€9 :
dr
€€: <
[
€€< =
$str
€€= J
]
€€J K
)
€€K L
,
€€L M

MetodoPago
‹‹ &
=
‹‹' (
dr
‹‹) +
[
‹‹+ ,
$str
‹‹, 8
]
‹‹8 9
.
‹‹9 :
ToString
‹‹: B
(
‹‹B C
)
‹‹C D
,
‹‹D E
Cedula
›› "
=
››# $
dr
››% '
[
››' (
$str
››( 0
]
››0 1
.
››1 2
ToString
››2 :
(
››: ;
)
››; <
,
››< =
	Ocupacion
ﬁﬁ %
=
ﬁﬁ& '
dr
ﬁﬁ( *
[
ﬁﬁ* +
$str
ﬁﬁ+ 6
]
ﬁﬁ6 7
.
ﬁﬁ7 8
ToString
ﬁﬁ8 @
(
ﬁﬁ@ A
)
ﬁﬁA B
}
ﬂﬂ 
)
ﬂﬂ 
;
ﬂﬂ 
}
‡‡ 
}
·· 
}
‚‚ 
return
„„ 
solicitudes
„„ 
;
„„ 
}
‰‰ 	
public
ÊÊ 
async
ÊÊ 
Task
ÊÊ 
<
ÊÊ 
bool
ÊÊ 
>
ÊÊ '
ActualizarEstadoSolicitud
ÊÊ  9
(
ÊÊ9 :
int
ÊÊ: =
id
ÊÊ> @
,
ÊÊ@ A
string
ÊÊB H
estado
ÊÊI O
)
ÊÊO P
{
ÁÁ 	
try
ÈÈ 
{
ÍÍ 
using
ÎÎ 
(
ÎÎ 
var
ÎÎ 
conexion
ÎÎ #
=
ÎÎ$ %
new
ÎÎ& )
SqlConnection
ÎÎ* 7
(
ÎÎ7 8
con
ÎÎ8 ;
.
ÎÎ; <
	CadenaSQL
ÎÎ< E
)
ÎÎE F
)
ÎÎF G
{
ÏÏ 
await
ÌÌ 
conexion
ÌÌ "
.
ÌÌ" #
	OpenAsync
ÌÌ# ,
(
ÌÌ, -
)
ÌÌ- .
;
ÌÌ. /
Console
ÓÓ 
.
ÓÓ 
	WriteLine
ÓÓ %
(
ÓÓ% &
estado
ÓÓ& ,
)
ÓÓ, -
;
ÓÓ- .

SqlCommand
ÔÔ 
cmd
ÔÔ "
=
ÔÔ# $
new
ÔÔ% (

SqlCommand
ÔÔ) 3
(
ÔÔ3 4
$str
ÔÔ4 R
,
ÔÔR S
conexion
ÔÔT \
)
ÔÔ\ ]
;
ÔÔ] ^
cmd
 
.
 

Parameters
 "
.
" #
AddWithValue
# /
(
/ 0
$str
0 5
,
5 6
id
7 9
)
9 :
;
: ;
cmd
ÒÒ 
.
ÒÒ 

Parameters
ÒÒ "
.
ÒÒ" #
AddWithValue
ÒÒ# /
(
ÒÒ/ 0
$str
ÒÒ0 9
,
ÒÒ9 :
estado
ÒÒ; A
)
ÒÒA B
;
ÒÒB C
cmd
ÚÚ 
.
ÚÚ 
CommandType
ÚÚ #
=
ÚÚ$ %
CommandType
ÚÚ& 1
.
ÚÚ1 2
StoredProcedure
ÚÚ2 A
;
ÚÚA B
int
ÙÙ 
rowsAffected
ÙÙ $
=
ÙÙ% &
await
ÙÙ' ,
cmd
ÙÙ- 0
.
ÙÙ0 1"
ExecuteNonQueryAsync
ÙÙ1 E
(
ÙÙE F
)
ÙÙF G
;
ÙÙG H
return
ıı 
rowsAffected
ıı '
>
ıı( )
$num
ıı* +
;
ıı+ ,
}
ˆˆ 
}
˜˜ 
catch
¯¯ 
(
¯¯ 
	Exception
¯¯ 
ex
¯¯ 
)
¯¯  
{
˘˘ 
return
˙˙ 
false
˙˙ 
;
˙˙ 
}
˚˚ 
}
¸¸ 	
public
˛˛ 
async
˛˛ 
Task
˛˛ 
<
˛˛ 
bool
˛˛ 
>
˛˛ &
CrearHistorialCrediticio
˛˛  8
(
˛˛8 9
Prestamo
˛˛9 A
.
˛˛A B
	Entidades
˛˛B K
.
˛˛K L!
HistorialCrediticio
˛˛L _
	historial
˛˛` i
)
˛˛i j
{
ˇˇ 	
using
ÄÄ 
(
ÄÄ 
var
ÄÄ 
conexion
ÄÄ 
=
ÄÄ  !
new
ÄÄ" %
SqlConnection
ÄÄ& 3
(
ÄÄ3 4
con
ÄÄ4 7
.
ÄÄ7 8
	CadenaSQL
ÄÄ8 A
)
ÄÄA B
)
ÄÄB C
{
ÅÅ 
await
ÇÇ 
conexion
ÇÇ 
.
ÇÇ 
	OpenAsync
ÇÇ (
(
ÇÇ( )
)
ÇÇ) *
;
ÇÇ* +

SqlCommand
ÉÉ 
cmd
ÉÉ 
=
ÉÉ  
new
ÉÉ! $

SqlCommand
ÉÉ% /
(
ÉÉ/ 0
$str
ÉÉ0 M
,
ÉÉM N
conexion
ÉÉO W
)
ÉÉW X
;
ÉÉX Y
cmd
ÑÑ 
.
ÑÑ 

Parameters
ÑÑ 
.
ÑÑ 
AddWithValue
ÑÑ +
(
ÑÑ+ ,
$str
ÑÑ, 8
,
ÑÑ8 9
	historial
ÑÑ: C
.
ÑÑC D
	IdUsuario
ÑÑD M
)
ÑÑM N
;
ÑÑN O
cmd
ÖÖ 
.
ÖÖ 

Parameters
ÖÖ 
.
ÖÖ 
AddWithValue
ÖÖ +
(
ÖÖ+ ,
$str
ÖÖ, ?
,
ÖÖ? @
	historial
ÖÖA J
.
ÖÖJ K
EstadoCrediticio
ÖÖK [
)
ÖÖ[ \
;
ÖÖ\ ]
cmd
ÜÜ 
.
ÜÜ 
CommandType
ÜÜ 
=
ÜÜ  !
CommandType
ÜÜ" -
.
ÜÜ- .
StoredProcedure
ÜÜ. =
;
ÜÜ= >
int
àà 
rowsAffected
àà  
=
àà! "
await
àà# (
cmd
àà) ,
.
àà, -"
ExecuteNonQueryAsync
àà- A
(
ààA B
)
ààB C
;
ààC D
return
ââ 
rowsAffected
ââ #
>
ââ$ %
$num
ââ& '
;
ââ' (
}
ää 
}
ãã 	
public
çç 
async
çç 
Task
çç 
<
çç 
bool
çç 
>
çç +
ActualizarHistorialCrediticio
çç  =
(
çç= >
int
çç> A
	idUsuario
ççB K
,
ççK L
bool
ççM Q
aprobado
ççR Z
)
ççZ [
{
éé 	
using
èè 
(
èè 
var
èè 
conexion
èè 
=
èè  !
new
èè" %
SqlConnection
èè& 3
(
èè3 4
con
èè4 7
.
èè7 8
	CadenaSQL
èè8 A
)
èèA B
)
èèB C
{
êê 
await
ëë 
conexion
ëë 
.
ëë 
	OpenAsync
ëë (
(
ëë( )
)
ëë) *
;
ëë* +

SqlCommand
íí 
cmd
íí 
=
íí  
new
íí! $

SqlCommand
íí% /
(
íí/ 0
$str
íí0 R
,
ííR S
conexion
ííT \
)
íí\ ]
;
íí] ^
cmd
ìì 
.
ìì 

Parameters
ìì 
.
ìì 
AddWithValue
ìì +
(
ìì+ ,
$str
ìì, 8
,
ìì8 9
	idUsuario
ìì: C
)
ììC D
;
ììD E
cmd
îî 
.
îî 

Parameters
îî 
.
îî 
AddWithValue
îî +
(
îî+ ,
$str
îî, 7
,
îî7 8
aprobado
îî9 A
)
îîA B
;
îîB C
cmd
ïï 
.
ïï 
CommandType
ïï 
=
ïï  !
CommandType
ïï" -
.
ïï- .
StoredProcedure
ïï. =
;
ïï= >
int
óó 
rowsAffected
óó  
=
óó! "
await
óó# (
cmd
óó) ,
.
óó, -"
ExecuteNonQueryAsync
óó- A
(
óóA B
)
óóB C
;
óóC D
return
òò 
rowsAffected
òò #
>
òò$ %
$num
òò& '
;
òò' (
}
ôô 
}
öö 	
public
úú 
async
úú 
Task
úú 
<
úú !
HistorialCrediticio
úú -
>
úú- .(
ObtenerHistorialCrediticio
úú/ I
(
úúI J
int
úúJ M
	idUsuario
úúN W
)
úúW X
{
ùù 	
using
ûû 
(
ûû 
var
ûû 
conexion
ûû 
=
ûû  !
new
ûû" %
SqlConnection
ûû& 3
(
ûû3 4
con
ûû4 7
.
ûû7 8
	CadenaSQL
ûû8 A
)
ûûA B
)
ûûB C
{
üü 
await
†† 
conexion
†† 
.
†† 
	OpenAsync
†† (
(
††( )
)
††) *
;
††* +

SqlCommand
°° 
cmd
°° 
=
°°  
new
°°! $

SqlCommand
°°% /
(
°°/ 0
$str
°°0 O
,
°°O P
conexion
°°Q Y
)
°°Y Z
;
°°Z [
cmd
¢¢ 
.
¢¢ 

Parameters
¢¢ 
.
¢¢ 
AddWithValue
¢¢ +
(
¢¢+ ,
$str
¢¢, 8
,
¢¢8 9
	idUsuario
¢¢: C
)
¢¢C D
;
¢¢D E
cmd
££ 
.
££ 
CommandType
££ 
=
££  !
CommandType
££" -
.
££- .
StoredProcedure
££. =
;
££= >
using
•• 
(
•• 
var
•• 
dr
•• 
=
•• 
await
••  %
cmd
••& )
.
••) * 
ExecuteReaderAsync
••* <
(
••< =
)
••= >
)
••> ?
{
¶¶ 
if
ßß 
(
ßß 
await
ßß 
dr
ßß  
.
ßß  !
	ReadAsync
ßß! *
(
ßß* +
)
ßß+ ,
)
ßß, -
{
®® 
return
©© 
new
©© "!
HistorialCrediticio
©©# 6
{
™™ 
	IdUsuario
´´ %
=
´´& '
Convert
´´( /
.
´´/ 0
ToInt32
´´0 7
(
´´7 8
dr
´´8 :
[
´´: ;
$str
´´; F
]
´´F G
)
´´G H
,
´´H I
EstadoCrediticio
¨¨ ,
=
¨¨- .
Convert
¨¨/ 6
.
¨¨6 7
ToInt32
¨¨7 >
(
¨¨> ?
dr
¨¨? A
[
¨¨A B
$str
¨¨B T
]
¨¨T U
)
¨¨U V
}
≠≠ 
;
≠≠ 
}
ÆÆ 
}
ØØ 
}
∞∞ 
return
±± 
null
±± 
;
±± 
}
≤≤ 	
public
¥¥ 
async
¥¥ 
Task
¥¥ 
<
¥¥ 
SolicitudPrestamo
¥¥ +
>
¥¥+ ,#
ObtenerSolicitudPorId
¥¥- B
(
¥¥B C
int
¥¥C F
id
¥¥G I
)
¥¥I J
{
µµ 	
using
∂∂ 
(
∂∂ 
var
∂∂ 
conexion
∂∂ 
=
∂∂  !
new
∂∂" %
SqlConnection
∂∂& 3
(
∂∂3 4
con
∂∂4 7
.
∂∂7 8
	CadenaSQL
∂∂8 A
)
∂∂A B
)
∂∂B C
{
∑∑ 
await
∏∏ 
conexion
∏∏ 
.
∏∏ 
	OpenAsync
∏∏ (
(
∏∏( )
)
∏∏) *
;
∏∏* +

SqlCommand
ππ 
cmd
ππ 
=
ππ  
new
ππ! $

SqlCommand
ππ% /
(
ππ/ 0
$str
ππ0 J
,
ππJ K
conexion
ππL T
)
ππT U
;
ππU V
cmd
∫∫ 
.
∫∫ 

Parameters
∫∫ 
.
∫∫ 
AddWithValue
∫∫ +
(
∫∫+ ,
$str
∫∫, 1
,
∫∫1 2
id
∫∫3 5
)
∫∫5 6
;
∫∫6 7
cmd
ªª 
.
ªª 
CommandType
ªª 
=
ªª  !
CommandType
ªª" -
.
ªª- .
StoredProcedure
ªª. =
;
ªª= >
using
ΩΩ 
(
ΩΩ 
var
ΩΩ 
dr
ΩΩ 
=
ΩΩ 
await
ΩΩ  %
cmd
ΩΩ& )
.
ΩΩ) * 
ExecuteReaderAsync
ΩΩ* <
(
ΩΩ< =
)
ΩΩ= >
)
ΩΩ> ?
{
ææ 
if
øø 
(
øø 
await
øø 
dr
øø  
.
øø  !
	ReadAsync
øø! *
(
øø* +
)
øø+ ,
)
øø, -
{
¿¿ 
return
¡¡ 
new
¡¡ "
SolicitudPrestamo
¡¡# 4
{
¬¬ 
Id
√√ 
=
√√  
Convert
√√! (
.
√√( )
ToInt32
√√) 0
(
√√0 1
dr
√√1 3
[
√√3 4
$str
√√4 8
]
√√8 9
)
√√9 :
,
√√: ;
	IdUsuario
ƒƒ %
=
ƒƒ& '
Convert
ƒƒ( /
.
ƒƒ/ 0
ToInt32
ƒƒ0 7
(
ƒƒ7 8
dr
ƒƒ8 :
[
ƒƒ: ;
$str
ƒƒ; F
]
ƒƒF G
)
ƒƒG H
,
ƒƒH I
Monto
≈≈ !
=
≈≈" #
Convert
≈≈$ +
.
≈≈+ ,
	ToDecimal
≈≈, 5
(
≈≈5 6
dr
≈≈6 8
[
≈≈8 9
$str
≈≈9 @
]
≈≈@ A
)
≈≈A B
,
≈≈B C
Plazo
∆∆ !
=
∆∆" #
Convert
∆∆$ +
.
∆∆+ ,
ToInt32
∆∆, 3
(
∆∆3 4
dr
∆∆4 6
[
∆∆6 7
$str
∆∆7 >
]
∆∆> ?
)
∆∆? @
,
∆∆@ A
Estado
«« "
=
««# $
dr
««% '
[
««' (
$str
««( 0
]
««0 1
.
««1 2
ToString
««2 :
(
««: ;
)
««; <
,
««< =
FechaSolicitud
»» *
=
»»+ ,
Convert
»»- 4
.
»»4 5

ToDateTime
»»5 ?
(
»»? @
dr
»»@ B
[
»»B C
$str
»»C S
]
»»S T
)
»»T U
,
»»U V
Sueldo
…… "
=
……# $
Convert
……% ,
.
……, -
	ToDecimal
……- 6
(
……6 7
dr
……7 9
[
……9 :
$str
……: B
]
……B C
)
……C D
,
……D E
EsCasado
   $
=
  % &
Convert
  ' .
.
  . /
	ToBoolean
  / 8
(
  8 9
dr
  9 ;
[
  ; <
$str
  < F
]
  F G
)
  G H
,
  H I
NumeroHijos
ÀÀ '
=
ÀÀ( )
Convert
ÀÀ* 1
.
ÀÀ1 2
ToInt32
ÀÀ2 9
(
ÀÀ9 :
dr
ÀÀ: <
[
ÀÀ< =
$str
ÀÀ= J
]
ÀÀJ K
)
ÀÀK L
,
ÀÀL M

MetodoPago
ÃÃ &
=
ÃÃ' (
dr
ÃÃ) +
[
ÃÃ+ ,
$str
ÃÃ, 8
]
ÃÃ8 9
.
ÃÃ9 :
ToString
ÃÃ: B
(
ÃÃB C
)
ÃÃC D
,
ÃÃD E
Cedula
ÕÕ "
=
ÕÕ# $
dr
ÕÕ% '
[
ÕÕ' (
$str
ÕÕ( 0
]
ÕÕ0 1
.
ÕÕ1 2
ToString
ÕÕ2 :
(
ÕÕ: ;
)
ÕÕ; <
,
ÕÕ< =
	Ocupacion
ŒŒ %
=
ŒŒ& '
dr
ŒŒ( *
[
ŒŒ* +
$str
ŒŒ+ 6
]
ŒŒ6 7
.
ŒŒ7 8
ToString
ŒŒ8 @
(
ŒŒ@ A
)
ŒŒA B
}
œœ 
;
œœ 
}
–– 
}
—— 
}
““ 
return
”” 
null
”” 
;
”” 
}
‘‘ 	
}
÷÷ 
}◊◊ ƒU
VC:\Users\USUARIO\Desktop\DesarrolloSeguro2\SistemaPrestamo\Prestamo.Data\MonedaData.cs
	namespace 	
Prestamo
 
. 
Data 
{ 
public 

class 

MonedaData 
{		 
private

 
readonly

 
ConnectionStrings

 *
con

+ .
;

. /
public 

MonedaData 
( 
IOptions "
<" #
ConnectionStrings# 4
>4 5
options6 =
)= >
{ 	
con 
= 
options 
. 
Value 
;  
} 	
public 
async 
Task 
< 
List 
< 
Moneda %
>% &
>& '
Lista( -
(- .
). /
{ 	
List 
< 
Moneda 
> 
lista 
=  
new! $
List% )
<) *
Moneda* 0
>0 1
(1 2
)2 3
;3 4
using 
( 
var 
conexion 
=  !
new" %
SqlConnection& 3
(3 4
con4 7
.7 8
	CadenaSQL8 A
)A B
)B C
{ 
await 
conexion 
. 
	OpenAsync (
(( )
)) *
;* +

SqlCommand 
cmd 
=  
new! $

SqlCommand% /
(/ 0
$str0 @
,@ A
conexionB J
)J K
;K L
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
using 
( 
var 
dr 
= 
await  %
cmd& )
.) *
ExecuteReaderAsync* <
(< =
)= >
)> ?
{ 
while 
( 
await  
dr! #
.# $
	ReadAsync$ -
(- .
). /
)/ 0
{ 
lista 
. 
Add !
(! "
new" %
Moneda& ,
(, -
)- .
{ 
IdMoneda   $
=  % &
Convert  ' .
.  . /
ToInt32  / 6
(  6 7
dr  7 9
[  9 :
$str  : D
]  D E
)  E F
,  F G
Nombre!! "
=!!# $
dr!!% '
[!!' (
$str!!( 0
]!!0 1
.!!1 2
ToString!!2 :
(!!: ;
)!!; <
!!!< =
,!!= >
Simbolo"" #
=""$ %
dr""& (
[""( )
$str"") 2
]""2 3
.""3 4
ToString""4 <
(""< =
)""= >
!""> ?
,""? @
FechaCreacion## )
=##* +
dr##, .
[##. /
$str##/ >
]##> ?
.##? @
ToString##@ H
(##H I
)##I J
!##J K
}$$ 
)$$ 
;$$ 
}%% 
}&& 
}'' 
return(( 
lista(( 
;(( 
})) 	
public++ 
async++ 
Task++ 
<++ 
string++  
>++  !
Crear++" '
(++' (
Moneda++( .
objeto++/ 5
)++5 6
{,, 	
string.. 
	respuesta.. 
=.. 
$str.. !
;..! "
using// 
(// 
var// 
conexion// 
=//  !
new//" %
SqlConnection//& 3
(//3 4
con//4 7
.//7 8
	CadenaSQL//8 A
)//A B
)//B C
{00 
await11 
conexion11 
.11 
	OpenAsync11 (
(11( )
)11) *
;11* +

SqlCommand22 
cmd22 
=22  
new22! $

SqlCommand22% /
(22/ 0
$str220 @
,22@ A
conexion22B J
)22J K
;22K L
cmd33 
.33 

Parameters33 
.33 
AddWithValue33 +
(33+ ,
$str33, 5
,335 6
objeto337 =
.33= >
Nombre33> D
)33D E
;33E F
cmd44 
.44 

Parameters44 
.44 
AddWithValue44 +
(44+ ,
$str44, 6
,446 7
objeto448 >
.44> ?
Simbolo44? F
)44F G
;44G H
cmd55 
.55 

Parameters55 
.55 
Add55 "
(55" #
$str55# .
,55. /
	SqlDbType550 9
.559 :
VarChar55: A
,55A B
$num55C F
)55F G
.55G H
	Direction55H Q
=55R S
ParameterDirection55T f
.55f g
Output55g m
;55m n
cmd66 
.66 
CommandType66 
=66  !
CommandType66" -
.66- .
StoredProcedure66. =
;66= >
try88 
{99 
await:: 
cmd:: 
.::  
ExecuteNonQueryAsync:: 2
(::2 3
)::3 4
;::4 5
	respuesta;; 
=;; 
Convert;;  '
.;;' (
ToString;;( 0
(;;0 1
cmd;;1 4
.;;4 5

Parameters;;5 ?
[;;? @
$str;;@ K
];;K L
.;;L M
Value;;M R
);;R S
!;;S T
;;;T U
}<< 
catch== 
{>> 
	respuesta?? 
=?? 
$str??  3
;??3 4
}@@ 
}AA 
returnBB 
	respuestaBB 
;BB 
}CC 	
publicEE 
asyncEE 
TaskEE 
<EE 
stringEE  
>EE  !
EditarEE" (
(EE( )
MonedaEE) /
objetoEE0 6
)EE6 7
{FF 	
stringHH 
	respuestaHH 
=HH 
$strHH !
;HH! "
usingII 
(II 
varII 
conexionII 
=II  !
newII" %
SqlConnectionII& 3
(II3 4
conII4 7
.II7 8
	CadenaSQLII8 A
)IIA B
)IIB C
{JJ 
awaitKK 
conexionKK 
.KK 
	OpenAsyncKK (
(KK( )
)KK) *
;KK* +

SqlCommandLL 
cmdLL 
=LL  
newLL! $

SqlCommandLL% /
(LL/ 0
$strLL0 A
,LLA B
conexionLLC K
)LLK L
;LLL M
cmdMM 
.MM 

ParametersMM 
.MM 
AddWithValueMM +
(MM+ ,
$strMM, 7
,MM7 8
objetoMM9 ?
.MM? @
IdMonedaMM@ H
)MMH I
;MMI J
cmdNN 
.NN 

ParametersNN 
.NN 
AddWithValueNN +
(NN+ ,
$strNN, 5
,NN5 6
objetoNN7 =
.NN= >
NombreNN> D
)NND E
;NNE F
cmdOO 
.OO 

ParametersOO 
.OO 
AddWithValueOO +
(OO+ ,
$strOO, 6
,OO6 7
objetoOO8 >
.OO> ?
SimboloOO? F
)OOF G
;OOG H
cmdPP 
.PP 

ParametersPP 
.PP 
AddPP "
(PP" #
$strPP# .
,PP. /
	SqlDbTypePP0 9
.PP9 :
VarCharPP: A
,PPA B
$numPPC F
)PPF G
.PPG H
	DirectionPPH Q
=PPR S
ParameterDirectionPPT f
.PPf g
OutputPPg m
;PPm n
cmdQQ 
.QQ 
CommandTypeQQ 
=QQ  !
CommandTypeQQ" -
.QQ- .
StoredProcedureQQ. =
;QQ= >
trySS 
{TT 
awaitUU 
cmdUU 
.UU  
ExecuteNonQueryAsyncUU 2
(UU2 3
)UU3 4
;UU4 5
	respuestaVV 
=VV 
ConvertVV  '
.VV' (
ToStringVV( 0
(VV0 1
cmdVV1 4
.VV4 5

ParametersVV5 ?
[VV? @
$strVV@ K
]VVK L
.VVL M
ValueVVM R
)VVR S
!VVS T
;VVT U
}WW 
catchXX 
{YY 
	respuestaZZ 
=ZZ 
$strZZ  3
;ZZ3 4
}[[ 
}\\ 
return]] 
	respuesta]] 
;]] 
}^^ 	
public`` 
async`` 
Task`` 
<`` 
string``  
>``  !
Eliminar``" *
(``* +
int``+ .
Id``/ 1
)``1 2
{aa 	
stringcc 
	respuestacc 
=cc 
$strcc !
;cc! "
usingdd 
(dd 
vardd 
conexiondd 
=dd  !
newdd" %
SqlConnectiondd& 3
(dd3 4
condd4 7
.dd7 8
	CadenaSQLdd8 A
)ddA B
)ddB C
{ee 
awaitff 
conexionff 
.ff 
	OpenAsyncff (
(ff( )
)ff) *
;ff* +

SqlCommandgg 
cmdgg 
=gg  
newgg! $

SqlCommandgg% /
(gg/ 0
$strgg0 C
,ggC D
conexionggE M
)ggM N
;ggN O
cmdhh 
.hh 

Parametershh 
.hh 
AddWithValuehh +
(hh+ ,
$strhh, 7
,hh7 8
Idhh9 ;
)hh; <
;hh< =
cmdii 
.ii 

Parametersii 
.ii 
Addii "
(ii" #
$strii# .
,ii. /
	SqlDbTypeii0 9
.ii9 :
VarCharii: A
,iiA B
$numiiC F
)iiF G
.iiG H
	DirectioniiH Q
=iiR S
ParameterDirectioniiT f
.iif g
Outputiig m
;iim n
cmdjj 
.jj 
CommandTypejj 
=jj  !
CommandTypejj" -
.jj- .
StoredProcedurejj. =
;jj= >
tryll 
{mm 
awaitnn 
cmdnn 
.nn  
ExecuteNonQueryAsyncnn 2
(nn2 3
)nn3 4
;nn4 5
	respuestaoo 
=oo 
Convertoo  '
.oo' (
ToStringoo( 0
(oo0 1
cmdoo1 4
.oo4 5

Parametersoo5 ?
[oo? @
$stroo@ K
]ooK L
.ooL M
ValueooM R
)ooR S
!ooS T
;ooT U
}pp 
catchqq 
{rr 
	respuestass 
=ss 
$strss  3
;ss3 4
}tt 
}uu 
returnvv 
	respuestavv 
;vv 
}ww 	
}xx 
}yy Ø
XC:\Users\USUARIO\Desktop\DesarrolloSeguro2\SistemaPrestamo\Prestamo.Data\EmailService.cs
	namespace

 	
Prestamo


 
.

 
Data

 
{ 
public 

class 
EmailService 
{ 
private 
readonly 
SmtpSettings %
_smtpSettings& 3
;3 4
public 
EmailService 
( 
IOptions $
<$ %
SmtpSettings% 1
>1 2
smtpSettings3 ?
)? @
{ 	
_smtpSettings 
= 
smtpSettings (
.( )
Value) .
;. /
} 	
public 
async 
Task 
EnviarCorreoAsync +
(+ ,
string, 2
destinatario3 ?
,? @
stringA G
asuntoH N
,N O
stringP V
mensajeW ^
)^ _
{ 	
using 
( 
var 
client 
= 
new  #

SmtpClient$ .
(. /
_smtpSettings/ <
.< =
Host= A
,A B
_smtpSettingsC P
.P Q
PortQ U
)U V
{ 
Credentials 
= 
new !
NetworkCredential" 3
(3 4
_smtpSettings4 A
.A B
UserNameB J
,J K
_smtpSettingsL Y
.Y Z
PasswordZ b
)b c
,c d
	EnableSsl 
= 
true  
,  !
} 
) 
{ 
var 
mailMessage 
=  !
new" %
MailMessage& 1
{ 
From 
= 
new 
MailAddress *
(* +
_smtpSettings+ 8
.8 9
UserName9 A
)A B
,B C
Subject   
=   
asunto   $
,  $ %
Body!! 
=!! 
mensaje!! "
,!!" #

IsBodyHtml"" 
=""  
true""! %
}## 
;## 
mailMessage$$ 
.$$ 
To$$ 
.$$ 
Add$$ "
($$" #
destinatario$$# /
)$$/ 0
;$$0 1
await&& 
client&& 
.&& 
SendMailAsync&& *
(&&* +
mailMessage&&+ 6
)&&6 7
;&&7 8
}'' 
}(( 	
})) 
public++ 

class++ 
SmtpSettings++ 
{,, 
public-- 
string-- 
Host-- 
{-- 
get--  
;--  !
set--" %
;--% &
}--' (
=--) *
null--+ /
!--/ 0
;--0 1
public.. 
int.. 
Port.. 
{.. 
get.. 
;.. 
set.. "
;.." #
}..$ %
public// 
bool// 
	EnableSsl// 
{// 
get//  #
;//# $
set//% (
;//( )
}//* +
public00 
string00 
UserName00 
{00  
get00! $
;00$ %
set00& )
;00) *
}00+ ,
=00- .
null00/ 3
!003 4
;004 5
public11 
string11 
Password11 
{11  
get11! $
;11$ %
set11& )
;11) *
}11+ ,
=11- .
null11/ 3
!113 4
;114 5
}22 
}33 ÁN
VC:\Users\USUARIO\Desktop\DesarrolloSeguro2\SistemaPrestamo\Prestamo.Data\CuentaData.cs
	namespace		 	
Prestamo		
 
.		 
Data		 
{

 
public 

class 

CuentaData 
{ 
private 
readonly 
ConnectionStrings *
con+ .
;. /
private 
readonly 
string 
encryptionKey  -
=. /
$str0 R
;R S
public 

CuentaData 
( 
IOptions "
<" #
ConnectionStrings# 4
>4 5
options6 =
)= >
{ 	
con 
= 
options 
. 
Value 
;  
} 	
private 
string 
Decrypt 
( 
string %

cipherText& 0
)0 1
{ 	
try 
{ 
var 

fullCipher 
=  
Convert! (
.( )
FromBase64String) 9
(9 :

cipherText: D
)D E
;E F
if 
( 

fullCipher 
. 
Length %
<& '
$num( *
)* +
{ 
throw 
new 
ArgumentException /
(/ 0
$str0 H
)H I
;I J
} 
using   
(   
var   
aes   
=    
Aes  ! $
.  $ %
Create  % +
(  + ,
)  , -
)  - .
{!! 
byte## 
[## 
]## 
iv## 
=## 
new##  #
byte##$ (
[##( )
$num##) +
]##+ ,
;##, -
Array$$ 
.$$ 
Copy$$ 
($$ 

fullCipher$$ )
,$$) *
$num$$+ ,
,$$, -
iv$$. 0
,$$0 1
$num$$2 3
,$$3 4
iv$$5 7
.$$7 8
Length$$8 >
)$$> ?
;$$? @
byte'' 
['' 
]'' 
cipher'' !
=''" #
new''$ '
byte''( ,
['', -

fullCipher''- 7
.''7 8
Length''8 >
-''? @
iv''A C
.''C D
Length''D J
]''J K
;''K L
Array(( 
.(( 
Copy(( 
((( 

fullCipher(( )
,(() *
iv((+ -
.((- .
Length((. 4
,((4 5
cipher((6 <
,((< =
$num((> ?
,((? @
cipher((A G
.((G H
Length((H N
)((N O
;((O P
byte++ 
[++ 
]++ 
key++ 
=++  
Encoding++! )
.++) *
UTF8++* .
.++. /
GetBytes++/ 7
(++7 8
encryptionKey++8 E
)++E F
;++F G
Array,, 
.,, 
Resize,,  
(,,  !
ref,,! $
key,,% (
,,,( )
$num,,* ,
),,, -
;,,- .
aes.. 
... 
Key.. 
=.. 
key.. !
;..! "
aes// 
.// 
IV// 
=// 
iv// 
;//  
using22 
(22 
var22 
	decryptor22 (
=22) *
aes22+ .
.22. /
CreateDecryptor22/ >
(22> ?
aes22? B
.22B C
Key22C F
,22F G
aes22H K
.22K L
IV22L N
)22N O
)22O P
using33 
(33 
var33 
ms33 !
=33" #
new33$ '
MemoryStream33( 4
(334 5
cipher335 ;
)33; <
)33< =
using44 
(44 
var44 
cs44 !
=44" #
new44$ '
CryptoStream44( 4
(444 5
ms445 7
,447 8
	decryptor449 B
,44B C
CryptoStreamMode44D T
.44T U
Read44U Y
)44Y Z
)44Z [
using55 
(55 
var55 
sr55 !
=55" #
new55$ '
StreamReader55( 4
(554 5
cs555 7
)557 8
)558 9
{66 
return77 
sr77 !
.77! "
	ReadToEnd77" +
(77+ ,
)77, -
;77- .
}88 
}99 
}:: 
catch;; 
(;; 
	Exception;; 
ex;; 
);;  
{<< 
return>> 
string>> 
.>> 
Empty>> #
;>># $
}?? 
}@@ 	
publicAA 
asyncAA 
TaskAA 
<AA 
CuentaAA  
>AA  !
ObtenerCuentaAA" /
(AA/ 0
intAA0 3
	idClienteAA4 =
)AA= >
{BB 	
CuentaCC 
cuentaCC 
=CC 
newCC 
CuentaCC  &
(CC& '
)CC' (
;CC( )
usingEE 
(EE 
varEE 
conexionEE 
=EE  !
newEE" %
SqlConnectionEE& 3
(EE3 4
conEE4 7
.EE7 8
	CadenaSQLEE8 A
)EEA B
)EEB C
{FF 
awaitGG 
conexionGG 
.GG 
	OpenAsyncGG (
(GG( )
)GG) *
;GG* +

SqlCommandHH 
cmdHH 
=HH  
newHH! $

SqlCommandHH% /
(HH/ 0
$strHH0 B
,HHB C
conexionHHD L
)HHL M
;HHM N
cmdII 
.II 

ParametersII 
.II 
AddWithValueII +
(II+ ,
$strII, 8
,II8 9
	idClienteII: C
)IIC D
;IID E
cmdJJ 
.JJ 
CommandTypeJJ 
=JJ  !
CommandTypeJJ" -
.JJ- .
StoredProcedureJJ. =
;JJ= >
usingLL 
(LL 
varLL 
drLL 
=LL 
awaitLL  %
cmdLL& )
.LL) *
ExecuteReaderAsyncLL* <
(LL< =
)LL= >
)LL> ?
{MM 
whileNN 
(NN 
awaitNN  
drNN! #
.NN# $
	ReadAsyncNN$ -
(NN- .
)NN. /
)NN/ 0
{OO 
cuentaPP 
=PP  
newPP! $
CuentaPP% +
(PP+ ,
)PP, -
{QQ 
IdCuentaRR $
=RR% &
ConvertRR' .
.RR. /
ToInt32RR/ 6
(RR6 7
drRR7 9
[RR9 :
$strRR: D
]RRD E
)RRE F
,RRF G
	IdClienteSS %
=SS& '
ConvertSS( /
.SS/ 0
ToInt32SS0 7
(SS7 8
drSS8 :
[SS: ;
$strSS; F
]SSF G
)SSG H
,SSH I
TarjetaTT #
=TT$ %
DecryptTT& -
(TT- .
drTT. 0
[TT0 1
$strTT1 :
]TT: ;
.TT; <
ToStringTT< D
(TTD E
)TTE F
!TTF G
)TTG H
,TTH I
MontoYY !
=YY" #
ConvertYY$ +
.YY+ ,
	ToDecimalYY, 5
(YY5 6
drYY6 8
[YY8 9
$strYY9 @
]YY@ A
)YYA B
}ZZ 
;ZZ 
;ZZ 
}[[ 
}\\ 
}]] 
return^^ 
cuenta^^ 
;^^ 
}__ 	
public`` 
async`` 
Task`` 
<`` 
string``  
>``  !
	Depositar``" +
(``+ ,
int``, /
	idCliente``0 9
,``9 :
decimal``; B
monto``C H
)``H I
{aa 	
stringbb 
	respuestabb 
=bb 
$strbb !
;bb! "
usingcc 
(cc 
varcc 
conexioncc 
=cc  !
newcc" %
SqlConnectioncc& 3
(cc3 4
concc4 7
.cc7 8
	CadenaSQLcc8 A
)ccA B
)ccB C
{dd 
awaitee 
conexionee 
.ee 
	OpenAsyncee (
(ee( )
)ee) *
;ee* +

SqlCommandff 
cmdff 
=ff  
newff! $

SqlCommandff% /
(ff/ 0
$strff0 D
,ffD E
conexionffF N
)ffN O
;ffO P
cmdgg 
.gg 

Parametersgg 
.gg 
AddWithValuegg +
(gg+ ,
$strgg, 8
,gg8 9
	idClientegg: C
)ggC D
;ggD E
cmdhh 
.hh 

Parametershh 
.hh 
AddWithValuehh +
(hh+ ,
$strhh, 4
,hh4 5
montohh6 ;
)hh; <
;hh< =
cmdii 
.ii 

Parametersii 
.ii 
Addii "
(ii" #
$strii# .
,ii. /
	SqlDbTypeii0 9
.ii9 :
VarCharii: A
,iiA B
$numiiC F
)iiF G
.iiG H
	DirectioniiH Q
=iiR S
ParameterDirectioniiT f
.iif g
Outputiig m
;iim n
cmdjj 
.jj 
CommandTypejj 
=jj  !
CommandTypejj" -
.jj- .
StoredProcedurejj. =
;jj= >
tryll 
{mm 
awaitnn 
cmdnn 
.nn  
ExecuteNonQueryAsyncnn 2
(nn2 3
)nn3 4
;nn4 5
	respuestaoo 
=oo 
Convertoo  '
.oo' (
ToStringoo( 0
(oo0 1
cmdoo1 4
.oo4 5

Parametersoo5 ?
[oo? @
$stroo@ K
]ooK L
.ooL M
ValueooM R
)ooR S
!ooS T
;ooT U
}pp 
catchqq 
{rr 
	respuestass 
=ss 
$strss  3
;ss3 4
}tt 
}uu 
returnvv 
	respuestavv 
;vv 
}ww 	
}xx 
}yy Ö
]C:\Users\USUARIO\Desktop\DesarrolloSeguro2\SistemaPrestamo\Prestamo.Data\ConnectionStrings.cs
	namespace 	
Prestamo
 
. 
Data 
{ 
public		 

class		 
ConnectionStrings		 "
{

 
public 
string 
	CadenaSQL 
{  !
get" %
;% &
set' *
;* +
}, -
=. /
null0 4
!4 5
;5 6
} 
} ›¡
WC:\Users\USUARIO\Desktop\DesarrolloSeguro2\SistemaPrestamo\Prestamo.Data\ClienteData.cs
	namespace 	
Prestamo
 
. 
Data 
{		 
public

 

class

 
ClienteData

 
{ 
private 
readonly 
ConnectionStrings *
con+ .
;. /
private 
readonly 
UsuarioData $
usuarioData% 0
;0 1
private 
readonly 
EmailService %
emailService& 2
;2 3
private 
readonly 
string 
encryptionKey  -
=. /
$str0 R
;R S
public 
ClienteData 
( 
IOptions #
<# $
ConnectionStrings$ 5
>5 6
options7 >
,> ?
UsuarioData@ K
usuarioDataL W
,W X
EmailServiceY e
emailServicef r
)r s
{ 	
con 
= 
options 
. 
Value 
;  
this 
. 
usuarioData 
= 
usuarioData *
;* +
this 
. 
emailService 
= 
emailService  ,
;, -
} 	
private 
string 
Encrypt 
( 
string %
	plainText& /
)/ 0
{ 	
using 
( 
var 
aes 
= 
Aes  
.  !
Create! '
(' (
)( )
)) *
{ 
byte 
[ 
] 
key 
= 
Encoding %
.% &
UTF8& *
.* +
GetBytes+ 3
(3 4
encryptionKey4 A
)A B
;B C
Array 
. 
Resize 
( 
ref  
key! $
,$ %
$num& (
)( )
;) *
aes 
. 
Key 
= 
key 
; 
aes!! 
.!! 

GenerateIV!! 
(!! 
)!!  
;!!  !
byte"" 
["" 
]"" 
iv"" 
="" 
aes"" 
.""  
IV""  "
;""" #
using$$ 
($$ 
var$$ 
	encryptor$$ $
=$$% &
aes$$' *
.$$* +
CreateEncryptor$$+ :
($$: ;
aes$$; >
.$$> ?
Key$$? B
,$$B C
aes$$D G
.$$G H
IV$$H J
)$$J K
)$$K L
using%% 
(%% 
var%% 
ms%% 
=%% 
new%%  #
MemoryStream%%$ 0
(%%0 1
)%%1 2
)%%2 3
{&& 
ms(( 
.(( 
Write(( 
((( 
iv(( 
,((  
$num((! "
,((" #
iv(($ &
.((& '
Length((' -
)((- .
;((. /
using)) 
()) 
var)) 
cs)) !
=))" #
new))$ '
CryptoStream))( 4
())4 5
ms))5 7
,))7 8
	encryptor))9 B
,))B C
CryptoStreamMode))D T
.))T U
Write))U Z
)))Z [
)))[ \
using** 
(** 
var** 
sw** !
=**" #
new**$ '
StreamWriter**( 4
(**4 5
cs**5 7
)**7 8
)**8 9
{++ 
sw,, 
.,, 
Write,,  
(,,  !
	plainText,,! *
),,* +
;,,+ ,
}-- 
return.. 
Convert.. "
..." #
ToBase64String..# 1
(..1 2
ms..2 4
...4 5
ToArray..5 <
(..< =
)..= >
)..> ?
;..? @
}// 
}00 
}11 	
public44 
async44 
Task44 
<44 
List44 
<44 
Cliente44 &
>44& '
>44' (
Lista44) .
(44. /
)44/ 0
{55 	
List66 
<66 
Cliente66 
>66 
lista66 
=66  !
new66" %
List66& *
<66* +
Cliente66+ 2
>662 3
(663 4
)664 5
;665 6
using88 
(88 
var88 
conexion88 
=88  !
new88" %
SqlConnection88& 3
(883 4
con884 7
.887 8
	CadenaSQL888 A
)88A B
)88B C
{99 
await:: 
conexion:: 
.:: 
	OpenAsync:: (
(::( )
)::) *
;::* +

SqlCommand;; 
cmd;; 
=;;  
new;;! $

SqlCommand;;% /
(;;/ 0
$str;;0 A
,;;A B
conexion;;C K
);;K L
;;;L M
cmd<< 
.<< 
CommandType<< 
=<<  !
CommandType<<" -
.<<- .
StoredProcedure<<. =
;<<= >
using>> 
(>> 
var>> 
dr>> 
=>> 
await>>  %
cmd>>& )
.>>) *
ExecuteReaderAsync>>* <
(>>< =
)>>= >
)>>> ?
{?? 
while@@ 
(@@ 
await@@  
dr@@! #
.@@# $
	ReadAsync@@$ -
(@@- .
)@@. /
)@@/ 0
{AA 
listaBB 
.BB 
AddBB !
(BB! "
newBB" %
ClienteBB& -
(BB- .
)BB. /
{CC 
	IdClienteDD %
=DD& '
ConvertDD( /
.DD/ 0
ToInt32DD0 7
(DD7 8
drDD8 :
[DD: ;
$strDD; F
]DDF G
)DDG H
,DDH I
NroDocumentoEE (
=EE) *
drEE+ -
[EE- .
$strEE. <
]EE< =
.EE= >
ToStringEE> F
(EEF G
)EEG H
!EEH I
,EEI J
NombreFF "
=FF# $
drFF% '
[FF' (
$strFF( 0
]FF0 1
.FF1 2
ToStringFF2 :
(FF: ;
)FF; <
!FF< =
,FF= >
ApellidoGG $
=GG% &
drGG' )
[GG) *
$strGG* 4
]GG4 5
.GG5 6
ToStringGG6 >
(GG> ?
)GG? @
!GG@ A
,GGA B
CorreoHH "
=HH# $
drHH% '
[HH' (
$strHH( 0
]HH0 1
.HH1 2
ToStringHH2 :
(HH: ;
)HH; <
!HH< =
,HH= >
TelefonoII $
=II% &
drII' )
[II) *
$strII* 4
]II4 5
.II5 6
ToStringII6 >
(II> ?
)II? @
!II@ A
,IIA B
FechaCreacionJJ )
=JJ* +
drJJ, .
[JJ. /
$strJJ/ >
]JJ> ?
.JJ? @
ToStringJJ@ H
(JJH I
)JJI J
!JJJ K
}KK 
)KK 
;KK 
}LL 
}MM 
}NN 
returnOO 
listaOO 
;OO 
}PP 	
publicQQ 
asyncQQ 
TaskQQ 
<QQ 
ClienteQQ !
>QQ! "
ObtenerQQ# *
(QQ* +
stringQQ+ 1
NroDocumentoQQ2 >
)QQ> ?
{RR 	
ClienteSS 
objetoSS 
=SS 
newSS  
ClienteSS! (
(SS( )
)SS) *
;SS* +
usingUU 
(UU 
varUU 
conexionUU 
=UU  !
newUU" %
SqlConnectionUU& 3
(UU3 4
conUU4 7
.UU7 8
	CadenaSQLUU8 A
)UUA B
)UUB C
{VV 
awaitWW 
conexionWW 
.WW 
	OpenAsyncWW (
(WW( )
)WW) *
;WW* +

SqlCommandXX 
cmdXX 
=XX  
newXX! $

SqlCommandXX% /
(XX/ 0
$strXX0 C
,XXC D
conexionXXE M
)XXM N
;XXN O
cmdYY 
.YY 

ParametersYY 
.YY 
AddWithValueYY +
(YY+ ,
$strYY, ;
,YY; <
NroDocumentoYY= I
)YYI J
;YYJ K
cmdZZ 
.ZZ 
CommandTypeZZ 
=ZZ  !
CommandTypeZZ" -
.ZZ- .
StoredProcedureZZ. =
;ZZ= >
using\\ 
(\\ 
var\\ 
dr\\ 
=\\ 
await\\  %
cmd\\& )
.\\) *
ExecuteReaderAsync\\* <
(\\< =
)\\= >
)\\> ?
{]] 
while^^ 
(^^ 
await^^  
dr^^! #
.^^# $
	ReadAsync^^$ -
(^^- .
)^^. /
)^^/ 0
{__ 
objeto`` 
=``  
new``! $
Cliente``% ,
(``, -
)``- .
{aa 
	IdClientebb %
=bb& '
Convertbb( /
.bb/ 0
ToInt32bb0 7
(bb7 8
drbb8 :
[bb: ;
$strbb; F
]bbF G
)bbG H
,bbH I
NroDocumentocc (
=cc) *
drcc+ -
[cc- .
$strcc. <
]cc< =
.cc= >
ToStringcc> F
(ccF G
)ccG H
!ccH I
,ccI J
Nombredd "
=dd# $
drdd% '
[dd' (
$strdd( 0
]dd0 1
.dd1 2
ToStringdd2 :
(dd: ;
)dd; <
!dd< =
,dd= >
Apellidoee $
=ee% &
dree' )
[ee) *
$stree* 4
]ee4 5
.ee5 6
ToStringee6 >
(ee> ?
)ee? @
!ee@ A
,eeA B
Correoff "
=ff# $
drff% '
[ff' (
$strff( 0
]ff0 1
.ff1 2
ToStringff2 :
(ff: ;
)ff; <
!ff< =
,ff= >
Telefonogg $
=gg% &
drgg' )
[gg) *
$strgg* 4
]gg4 5
.gg5 6
ToStringgg6 >
(gg> ?
)gg? @
!gg@ A
,ggA B
FechaCreacionhh )
=hh* +
drhh, .
[hh. /
$strhh/ >
]hh> ?
.hh? @
ToStringhh@ H
(hhH I
)hhI J
!hhJ K
}ii 
;ii 
}jj 
}kk 
}ll 
returnmm 
objetomm 
;mm 
}nn 	
privatepp 
stringpp 
GenerarTarjetapp %
(pp% &
)pp& '
{qq 	
usingrr 
(rr 
varrr 
rngrr 
=rr !
RandomNumberGeneratorrr 2
.rr2 3
Createrr3 9
(rr9 :
)rr: ;
)rr; <
{ss 
vartt 
bytestt 
=tt 
newtt 
bytett  $
[tt$ %
$numtt% &
]tt& '
;tt' (
rnguu 
.uu 
GetBytesuu 
(uu 
bytesuu "
)uu" #
;uu# $
varvv 
buildervv 
=vv 
newvv !
StringBuildervv" /
(vv/ 0
)vv0 1
;vv1 2
foreachww 
(ww 
varww 
bww 
inww !
bytesww" '
)ww' (
{xx 
builderyy 
.yy 
Appendyy "
(yy" #
byy# $
.yy$ %
ToStringyy% -
(yy- .
$stryy. 2
)yy2 3
)yy3 4
;yy4 5
}zz 
return{{ 
builder{{ 
.{{ 
ToString{{ '
({{' (
){{( )
;{{) *
}|| 
}}} 	
public 
async 
Task 
< 
string  
>  !
CrearCuenta" -
(- .
Cuenta. 4
cuenta5 ;
); <
{
ÄÄ 	
string
ÅÅ 
	respuesta
ÅÅ 
=
ÅÅ 
$str
ÅÅ !
;
ÅÅ! "
using
ÇÇ 
(
ÇÇ 
var
ÇÇ 
conexion
ÇÇ 
=
ÇÇ  !
new
ÇÇ" %
SqlConnection
ÇÇ& 3
(
ÇÇ3 4
con
ÇÇ4 7
.
ÇÇ7 8
	CadenaSQL
ÇÇ8 A
)
ÇÇA B
)
ÇÇB C
{
ÉÉ 
await
ÑÑ 
conexion
ÑÑ 
.
ÑÑ 
	OpenAsync
ÑÑ (
(
ÑÑ( )
)
ÑÑ) *
;
ÑÑ* +

SqlCommand
ÖÖ 
cmd
ÖÖ 
=
ÖÖ  
new
ÖÖ! $

SqlCommand
ÖÖ% /
(
ÖÖ/ 0
$str
ÖÖ0 @
,
ÖÖ@ A
conexion
ÖÖB J
)
ÖÖJ K
;
ÖÖK L
cmd
ÜÜ 
.
ÜÜ 

Parameters
ÜÜ 
.
ÜÜ 
AddWithValue
ÜÜ +
(
ÜÜ+ ,
$str
ÜÜ, 8
,
ÜÜ8 9
cuenta
ÜÜ: @
.
ÜÜ@ A
	IdCliente
ÜÜA J
)
ÜÜJ K
;
ÜÜK L
cmd
áá 
.
áá 

Parameters
áá 
.
áá 
Add
áá "
(
áá" #
$str
áá# -
,
áá- .
	SqlDbType
áá/ 8
.
áá8 9
VarChar
áá9 @
,
áá@ A
$num
ááB E
)
ááE F
.
ááF G
Value
ááG L
=
ááM N
Encrypt
ááO V
(
ááV W
cuenta
ááW ]
.
áá] ^
Tarjeta
áá^ e
)
ááe f
;
ááf g
Console
àà 
.
àà 
	WriteLine
àà !
(
àà! "
$str
àà" 8
+
àà9 :
Encrypt
àà; B
(
ààB C
cuenta
ààC I
.
ààI J
Tarjeta
ààJ Q
)
ààQ R
)
ààR S
;
ààS T
cmd
ââ 
.
ââ 

Parameters
ââ 
.
ââ 
AddWithValue
ââ +
(
ââ+ ,
$str
ââ, 4
,
ââ4 5
cuenta
ââ6 <
.
ââ< =
Monto
ââ= B
)
ââB C
;
ââC D
cmd
ää 
.
ää 

Parameters
ää 
.
ää 
Add
ää "
(
ää" #
$str
ää# .
,
ää. /
	SqlDbType
ää0 9
.
ää9 :
VarChar
ää: A
,
ääA B
$num
ääC F
)
ääF G
.
ääG H
	Direction
ääH Q
=
ääR S 
ParameterDirection
ääT f
.
ääf g
Output
ääg m
;
ääm n
cmd
ãã 
.
ãã 
CommandType
ãã 
=
ãã  !
CommandType
ãã" -
.
ãã- .
StoredProcedure
ãã. =
;
ãã= >
try
çç 
{
éé 
await
èè 
cmd
èè 
.
èè "
ExecuteNonQueryAsync
èè 2
(
èè2 3
)
èè3 4
;
èè4 5
	respuesta
êê 
=
êê 
Convert
êê  '
.
êê' (
ToString
êê( 0
(
êê0 1
cmd
êê1 4
.
êê4 5

Parameters
êê5 ?
[
êê? @
$str
êê@ K
]
êêK L
.
êêL M
Value
êêM R
)
êêR S
!
êêS T
;
êêT U
}
ëë 
catch
íí 
{
ìì 
	respuesta
îî 
=
îî 
$str
îî  3
;
îî3 4
}
ïï 
}
ññ 
return
óó 
	respuesta
óó 
;
óó 
}
òò 	
public
öö 
async
öö 
Task
öö 
<
öö 
string
öö  
>
öö  !
Crear
öö" '
(
öö' (
Cliente
öö( /
objeto
öö0 6
)
öö6 7
{
õõ 	
string
úú 
	respuesta
úú 
=
úú 
$str
úú !
;
úú! "
using
ùù 
(
ùù 
var
ùù 
conexion
ùù 
=
ùù  !
new
ùù" %
SqlConnection
ùù& 3
(
ùù3 4
con
ùù4 7
.
ùù7 8
	CadenaSQL
ùù8 A
)
ùùA B
)
ùùB C
{
ûû 
await
üü 
conexion
üü 
.
üü 
	OpenAsync
üü (
(
üü( )
)
üü) *
;
üü* +

SqlCommand
†† 
cmd
†† 
=
††  
new
††! $

SqlCommand
††% /
(
††/ 0
$str
††0 A
,
††A B
conexion
††C K
)
††K L
;
††L M
cmd
°° 
.
°° 

Parameters
°° 
.
°° 
AddWithValue
°° +
(
°°+ ,
$str
°°, ;
,
°°; <
objeto
°°= C
.
°°C D
NroDocumento
°°D P
)
°°P Q
;
°°Q R
cmd
¢¢ 
.
¢¢ 

Parameters
¢¢ 
.
¢¢ 
AddWithValue
¢¢ +
(
¢¢+ ,
$str
¢¢, 5
,
¢¢5 6
objeto
¢¢7 =
.
¢¢= >
Nombre
¢¢> D
)
¢¢D E
;
¢¢E F
cmd
££ 
.
££ 

Parameters
££ 
.
££ 
AddWithValue
££ +
(
££+ ,
$str
££, 7
,
££7 8
objeto
££9 ?
.
££? @
Apellido
££@ H
)
££H I
;
££I J
cmd
§§ 
.
§§ 

Parameters
§§ 
.
§§ 
AddWithValue
§§ +
(
§§+ ,
$str
§§, 5
,
§§5 6
objeto
§§7 =
.
§§= >
Correo
§§> D
)
§§D E
;
§§E F
cmd
•• 
.
•• 

Parameters
•• 
.
•• 
AddWithValue
•• +
(
••+ ,
$str
••, 7
,
••7 8
objeto
••9 ?
.
••? @
Telefono
••@ H
)
••H I
;
••I J
cmd
¶¶ 
.
¶¶ 

Parameters
¶¶ 
.
¶¶ 
Add
¶¶ "
(
¶¶" #
$str
¶¶# /
,
¶¶/ 0
	SqlDbType
¶¶1 :
.
¶¶: ;
Int
¶¶; >
)
¶¶> ?
.
¶¶? @
	Direction
¶¶@ I
=
¶¶J K 
ParameterDirection
¶¶L ^
.
¶¶^ _
Output
¶¶_ e
;
¶¶e f
cmd
ßß 
.
ßß 

Parameters
ßß 
.
ßß 
Add
ßß "
(
ßß" #
$str
ßß# .
,
ßß. /
	SqlDbType
ßß0 9
.
ßß9 :
VarChar
ßß: A
,
ßßA B
$num
ßßC F
)
ßßF G
.
ßßG H
	Direction
ßßH Q
=
ßßR S 
ParameterDirection
ßßT f
.
ßßf g
Output
ßßg m
;
ßßm n
cmd
®® 
.
®® 
CommandType
®® 
=
®®  !
CommandType
®®" -
.
®®- .
StoredProcedure
®®. =
;
®®= >
try
™™ 
{
´´ 
await
¨¨ 
cmd
¨¨ 
.
¨¨ "
ExecuteNonQueryAsync
¨¨ 2
(
¨¨2 3
)
¨¨3 4
;
¨¨4 5
	respuesta
≠≠ 
=
≠≠ 
Convert
≠≠  '
.
≠≠' (
ToString
≠≠( 0
(
≠≠0 1
cmd
≠≠1 4
.
≠≠4 5

Parameters
≠≠5 ?
[
≠≠? @
$str
≠≠@ K
]
≠≠K L
.
≠≠L M
Value
≠≠M R
)
≠≠R S
!
≠≠S T
;
≠≠T U
if
ØØ 
(
ØØ 
	respuesta
ØØ !
==
ØØ" $
$str
ØØ% '
)
ØØ' (
{
∞∞ 
objeto
≤≤ 
.
≤≤ 
	IdCliente
≤≤ (
=
≤≤) *
Convert
≤≤+ 2
.
≤≤2 3
ToInt32
≤≤3 :
(
≤≤: ;
cmd
≤≤; >
.
≤≤> ?

Parameters
≤≤? I
[
≤≤I J
$str
≤≤J V
]
≤≤V W
.
≤≤W X
Value
≤≤X ]
)
≤≤] ^
;
≤≤^ _
string
µµ 
claveAleatoria
µµ -
=
µµ. /
usuarioData
µµ0 ;
.
µµ; <#
GenerarClaveAleatoria
µµ< Q
(
µµQ R
$num
µµR T
)
µµT U
;
µµU V
string
∏∏ 
hashedClave
∏∏ *
=
∏∏+ ,
BCrypt
∏∏- 3
.
∏∏3 4
Net
∏∏4 7
.
∏∏7 8
BCrypt
∏∏8 >
.
∏∏> ?
HashPassword
∏∏? K
(
∏∏K L
claveAleatoria
∏∏L Z
)
∏∏Z [
;
∏∏[ \
Usuario
ªª 
nuevoUsuario
ªª  ,
=
ªª- .
new
ªª/ 2
Usuario
ªª3 :
{
ºº 
NombreCompleto
ΩΩ *
=
ΩΩ+ ,
objeto
ΩΩ- 3
.
ΩΩ3 4
Nombre
ΩΩ4 :
+
ΩΩ; <
$str
ΩΩ= @
+
ΩΩA B
objeto
ΩΩC I
.
ΩΩI J
Apellido
ΩΩJ R
,
ΩΩR S
Correo
ææ "
=
ææ# $
objeto
ææ% +
.
ææ+ ,
Correo
ææ, 2
,
ææ2 3
Clave
øø !
=
øø" #
hashedClave
øø$ /
,
øø/ 0
Rol
¿¿ 
=
¿¿  !
$str
¿¿" +
}
¡¡ 
;
¡¡ 
await
√√ 
usuarioData
√√ )
.
√√) *
Crear
√√* /
(
√√/ 0
nuevoUsuario
√√0 <
)
√√< =
;
√√= >
string
∆∆ 
asunto
∆∆ %
=
∆∆& '
$str
∆∆( F
;
∆∆F G
string
«« 
mensaje
«« &
=
««' (
$"
««) +
$str
««+ 0
{
««0 1
objeto
««1 7
.
««7 8
Nombre
««8 >
+
««? @
$str
««A D
+
««E F
objeto
««G M
.
««M N
Apellido
««N V
}
««V W
$str««W û
{««û ü
claveAleatoria««ü ≠
}««≠ Æ
$str««Æ ﬁ
"««ﬁ ﬂ
;««ﬂ ‡
await
»» 
emailService
»» *
.
»»* +
EnviarCorreoAsync
»»+ <
(
»»< =
objeto
»»= C
.
»»C D
Correo
»»D J
,
»»J K
asunto
»»L R
,
»»R S
mensaje
»»T [
)
»»[ \
;
»»\ ]
Cuenta
   
nuevaCuenta
   *
=
  + ,
new
  - 0
Cuenta
  1 7
{
ÀÀ 
	IdCliente
ÃÃ %
=
ÃÃ& '
objeto
ÃÃ( .
.
ÃÃ. /
	IdCliente
ÃÃ/ 8
,
ÃÃ8 9
Tarjeta
ÕÕ #
=
ÕÕ$ %
GenerarTarjeta
ÕÕ& 4
(
ÕÕ4 5
)
ÕÕ5 6
,
ÕÕ6 7
Monto
ŒŒ !
=
ŒŒ" #
$num
ŒŒ$ %
}
œœ 
;
œœ 
string
—— 
respuestaCuenta
—— .
=
——/ 0
await
——1 6
CrearCuenta
——7 B
(
——B C
nuevaCuenta
——C N
)
——N O
;
——O P
if
““ 
(
““ 
!
““ 
string
““ #
.
““# $
IsNullOrEmpty
““$ 1
(
““1 2
respuestaCuenta
““2 A
)
““A B
)
““B C
{
”” 
throw
‘‘ !
new
‘‘" %
	Exception
‘‘& /
(
‘‘/ 0
respuestaCuenta
‘‘0 ?
)
‘‘? @
;
‘‘@ A
}
’’ 
Console
◊◊ 
.
◊◊  
	WriteLine
◊◊  )
(
◊◊) *
$str
◊◊* 9
)
◊◊9 :
;
◊◊: ;
Console
ÿÿ 
.
ÿÿ  
	WriteLine
ÿÿ  )
(
ÿÿ) *
nuevaCuenta
ÿÿ* 5
.
ÿÿ5 6
Tarjeta
ÿÿ6 =
)
ÿÿ= >
;
ÿÿ> ?
}
ŸŸ 
}
⁄⁄ 
catch
€€ 
(
€€ 
	Exception
€€  
ex
€€! #
)
€€# $
{
‹‹ 
	respuesta
›› 
=
›› 
$str
››  5
+
››6 7
ex
››8 :
.
››: ;
Message
››; B
;
››B C
Console
ﬁﬁ 
.
ﬁﬁ 
	WriteLine
ﬁﬁ %
(
ﬁﬁ% &
$str
ﬁﬁ& /
+
ﬁﬁ0 1
ex
ﬁﬁ2 4
.
ﬁﬁ4 5
Message
ﬁﬁ5 <
)
ﬁﬁ< =
;
ﬁﬁ= >
}
ﬂﬂ 
}
‡‡ 
return
·· 
	respuesta
·· 
;
·· 
}
‚‚ 	
public
‰‰ 
async
‰‰ 
Task
‰‰ 
<
‰‰ 
string
‰‰  
>
‰‰  !
Editar
‰‰" (
(
‰‰( )
Cliente
‰‰) 0
objeto
‰‰1 7
)
‰‰7 8
{
ÂÂ 	
string
ÁÁ 
	respuesta
ÁÁ 
=
ÁÁ 
$str
ÁÁ !
;
ÁÁ! "
using
ËË 
(
ËË 
var
ËË 
conexion
ËË 
=
ËË  !
new
ËË" %
SqlConnection
ËË& 3
(
ËË3 4
con
ËË4 7
.
ËË7 8
	CadenaSQL
ËË8 A
)
ËËA B
)
ËËB C
{
ÈÈ 
await
ÍÍ 
conexion
ÍÍ 
.
ÍÍ 
	OpenAsync
ÍÍ (
(
ÍÍ( )
)
ÍÍ) *
;
ÍÍ* +

SqlCommand
ÎÎ 
cmd
ÎÎ 
=
ÎÎ  
new
ÎÎ! $

SqlCommand
ÎÎ% /
(
ÎÎ/ 0
$str
ÎÎ0 B
,
ÎÎB C
conexion
ÎÎD L
)
ÎÎL M
;
ÎÎM N
cmd
ÏÏ 
.
ÏÏ 

Parameters
ÏÏ 
.
ÏÏ 
AddWithValue
ÏÏ +
(
ÏÏ+ ,
$str
ÏÏ, 8
,
ÏÏ8 9
objeto
ÏÏ: @
.
ÏÏ@ A
	IdCliente
ÏÏA J
)
ÏÏJ K
;
ÏÏK L
cmd
ÌÌ 
.
ÌÌ 

Parameters
ÌÌ 
.
ÌÌ 
AddWithValue
ÌÌ +
(
ÌÌ+ ,
$str
ÌÌ, ;
,
ÌÌ; <
objeto
ÌÌ= C
.
ÌÌC D
NroDocumento
ÌÌD P
)
ÌÌP Q
;
ÌÌQ R
cmd
ÓÓ 
.
ÓÓ 

Parameters
ÓÓ 
.
ÓÓ 
AddWithValue
ÓÓ +
(
ÓÓ+ ,
$str
ÓÓ, 5
,
ÓÓ5 6
objeto
ÓÓ7 =
.
ÓÓ= >
Nombre
ÓÓ> D
)
ÓÓD E
;
ÓÓE F
cmd
ÔÔ 
.
ÔÔ 

Parameters
ÔÔ 
.
ÔÔ 
AddWithValue
ÔÔ +
(
ÔÔ+ ,
$str
ÔÔ, 7
,
ÔÔ7 8
objeto
ÔÔ9 ?
.
ÔÔ? @
Apellido
ÔÔ@ H
)
ÔÔH I
;
ÔÔI J
cmd
 
.
 

Parameters
 
.
 
AddWithValue
 +
(
+ ,
$str
, 5
,
5 6
objeto
7 =
.
= >
Correo
> D
)
D E
;
E F
cmd
ÒÒ 
.
ÒÒ 

Parameters
ÒÒ 
.
ÒÒ 
AddWithValue
ÒÒ +
(
ÒÒ+ ,
$str
ÒÒ, 7
,
ÒÒ7 8
objeto
ÒÒ9 ?
.
ÒÒ? @
Telefono
ÒÒ@ H
)
ÒÒH I
;
ÒÒI J
cmd
ÚÚ 
.
ÚÚ 

Parameters
ÚÚ 
.
ÚÚ 
Add
ÚÚ "
(
ÚÚ" #
$str
ÚÚ# .
,
ÚÚ. /
	SqlDbType
ÚÚ0 9
.
ÚÚ9 :
VarChar
ÚÚ: A
,
ÚÚA B
$num
ÚÚC F
)
ÚÚF G
.
ÚÚG H
	Direction
ÚÚH Q
=
ÚÚR S 
ParameterDirection
ÚÚT f
.
ÚÚf g
Output
ÚÚg m
;
ÚÚm n
cmd
ÛÛ 
.
ÛÛ 
CommandType
ÛÛ 
=
ÛÛ  !
CommandType
ÛÛ" -
.
ÛÛ- .
StoredProcedure
ÛÛ. =
;
ÛÛ= >
try
ıı 
{
ˆˆ 
await
˜˜ 
cmd
˜˜ 
.
˜˜ "
ExecuteNonQueryAsync
˜˜ 2
(
˜˜2 3
)
˜˜3 4
;
˜˜4 5
	respuesta
¯¯ 
=
¯¯ 
Convert
¯¯  '
.
¯¯' (
ToString
¯¯( 0
(
¯¯0 1
cmd
¯¯1 4
.
¯¯4 5

Parameters
¯¯5 ?
[
¯¯? @
$str
¯¯@ K
]
¯¯K L
.
¯¯L M
Value
¯¯M R
)
¯¯R S
!
¯¯S T
;
¯¯T U
}
˘˘ 
catch
˙˙ 
{
˚˚ 
	respuesta
¸¸ 
=
¸¸ 
$str
¸¸  3
;
¸¸3 4
}
˝˝ 
}
˛˛ 
return
ˇˇ 
	respuesta
ˇˇ 
;
ˇˇ 
}
ÄÄ 	
public
ÇÇ 
async
ÇÇ 
Task
ÇÇ 
<
ÇÇ 
string
ÇÇ  
>
ÇÇ  !
Eliminar
ÇÇ" *
(
ÇÇ* +
int
ÇÇ+ .
Id
ÇÇ/ 1
)
ÇÇ1 2
{
ÉÉ 	
string
ÖÖ 
	respuesta
ÖÖ 
=
ÖÖ 
$str
ÖÖ !
;
ÖÖ! "
using
ÜÜ 
(
ÜÜ 
var
ÜÜ 
conexion
ÜÜ 
=
ÜÜ  !
new
ÜÜ" %
SqlConnection
ÜÜ& 3
(
ÜÜ3 4
con
ÜÜ4 7
.
ÜÜ7 8
	CadenaSQL
ÜÜ8 A
)
ÜÜA B
)
ÜÜB C
{
áá 
await
àà 
conexion
àà 
.
àà 
	OpenAsync
àà (
(
àà( )
)
àà) *
;
àà* +

SqlCommand
ââ 
cmd
ââ 
=
ââ  
new
ââ! $

SqlCommand
ââ% /
(
ââ/ 0
$str
ââ0 D
,
ââD E
conexion
ââF N
)
ââN O
;
ââO P
cmd
ää 
.
ää 

Parameters
ää 
.
ää 
AddWithValue
ää +
(
ää+ ,
$str
ää, 8
,
ää8 9
Id
ää: <
)
ää< =
;
ää= >
cmd
ãã 
.
ãã 

Parameters
ãã 
.
ãã 
Add
ãã "
(
ãã" #
$str
ãã# .
,
ãã. /
	SqlDbType
ãã0 9
.
ãã9 :
VarChar
ãã: A
,
ããA B
$num
ããC F
)
ããF G
.
ããG H
	Direction
ããH Q
=
ããR S 
ParameterDirection
ããT f
.
ããf g
Output
ããg m
;
ããm n
cmd
åå 
.
åå 
CommandType
åå 
=
åå  !
CommandType
åå" -
.
åå- .
StoredProcedure
åå. =
;
åå= >
try
éé 
{
èè 
await
êê 
cmd
êê 
.
êê "
ExecuteNonQueryAsync
êê 2
(
êê2 3
)
êê3 4
;
êê4 5
	respuesta
ëë 
=
ëë 
Convert
ëë  '
.
ëë' (
ToString
ëë( 0
(
ëë0 1
cmd
ëë1 4
.
ëë4 5

Parameters
ëë5 ?
[
ëë? @
$str
ëë@ K
]
ëëK L
.
ëëL M
Value
ëëM R
)
ëëR S
!
ëëS T
;
ëëT U
}
íí 
catch
ìì 
{
îî 
	respuesta
ïï 
=
ïï 
$str
ïï  3
;
ïï3 4
}
ññ 
}
óó 
return
òò 
	respuesta
òò 
;
òò 
}
ôô 	
public
õõ 
async
õõ 
Task
õõ 
<
õõ 
Cliente
õõ !
>
õõ! "
ObtenerPorCorreo
õõ# 3
(
õõ3 4
string
õõ4 :
correo
õõ; A
)
õõA B
{
úú 	
Cliente
ùù 
cliente
ùù 
=
ùù 
null
ùù "
;
ùù" #
if
†† 
(
†† 
string
†† 
.
†† 
IsNullOrEmpty
†† $
(
††$ %
correo
††% +
)
††+ ,
)
††, -
{
°° 
throw
¢¢ 
new
¢¢ 
ArgumentException
¢¢ +
(
¢¢+ ,
$str
¢¢, L
)
¢¢L M
;
¢¢M N
}
££ 
using
•• 
(
•• 
var
•• 
conexion
•• 
=
••  !
new
••" %
SqlConnection
••& 3
(
••3 4
con
••4 7
.
••7 8
	CadenaSQL
••8 A
)
••A B
)
••B C
{
¶¶ 
await
ßß 
conexion
ßß 
.
ßß 
	OpenAsync
ßß (
(
ßß( )
)
ßß) *
;
ßß* +
using
©© 
(
©© 

SqlCommand
©© !
cmd
©©" %
=
©©& '
new
©©( +

SqlCommand
©©, 6
(
©©6 7
$str
©©7 S
,
©©S T
conexion
©©U ]
)
©©] ^
)
©©^ _
{
™™ 
cmd
´´ 
.
´´ 
CommandType
´´ #
=
´´$ %
CommandType
´´& 1
.
´´1 2
StoredProcedure
´´2 A
;
´´A B
cmd
ÆÆ 
.
ÆÆ 

Parameters
ÆÆ "
.
ÆÆ" #
AddWithValue
ÆÆ# /
(
ÆÆ/ 0
$str
ÆÆ0 9
,
ÆÆ9 :
correo
ÆÆ; A
??
ÆÆB D
string
ÆÆE K
.
ÆÆK L
Empty
ÆÆL Q
)
ÆÆQ R
;
ÆÆR S
using
∞∞ 
(
∞∞ 
var
∞∞ 
dr
∞∞ !
=
∞∞" #
await
∞∞$ )
cmd
∞∞* -
.
∞∞- . 
ExecuteReaderAsync
∞∞. @
(
∞∞@ A
)
∞∞A B
)
∞∞B C
{
±± 
if
≤≤ 
(
≤≤ 
await
≤≤ !
dr
≤≤" $
.
≤≤$ %
	ReadAsync
≤≤% .
(
≤≤. /
)
≤≤/ 0
)
≤≤0 1
{
≥≥ 
cliente
¥¥ #
=
¥¥$ %
new
¥¥& )
Cliente
¥¥* 1
(
¥¥1 2
)
¥¥2 3
{
µµ 
	IdCliente
∂∂  )
=
∂∂* +
Convert
∂∂, 3
.
∂∂3 4
ToInt32
∂∂4 ;
(
∂∂; <
dr
∂∂< >
[
∂∂> ?
$str
∂∂? J
]
∂∂J K
)
∂∂K L
,
∂∂L M
NroDocumento
∑∑  ,
=
∑∑- .
dr
∑∑/ 1
[
∑∑1 2
$str
∑∑2 @
]
∑∑@ A
.
∑∑A B
ToString
∑∑B J
(
∑∑J K
)
∑∑K L
,
∑∑L M
Nombre
∏∏  &
=
∏∏' (
dr
∏∏) +
[
∏∏+ ,
$str
∏∏, 4
]
∏∏4 5
.
∏∏5 6
ToString
∏∏6 >
(
∏∏> ?
)
∏∏? @
,
∏∏@ A
Apellido
ππ  (
=
ππ) *
dr
ππ+ -
[
ππ- .
$str
ππ. 8
]
ππ8 9
.
ππ9 :
ToString
ππ: B
(
ππB C
)
ππC D
,
ππD E
Correo
∫∫  &
=
∫∫' (
dr
∫∫) +
[
∫∫+ ,
$str
∫∫, 4
]
∫∫4 5
.
∫∫5 6
ToString
∫∫6 >
(
∫∫> ?
)
∫∫? @
,
∫∫@ A
Telefono
ªª  (
=
ªª) *
dr
ªª+ -
[
ªª- .
$str
ªª. 8
]
ªª8 9
.
ªª9 :
ToString
ªª: B
(
ªªB C
)
ªªC D
,
ªªD E
FechaCreacion
ºº  -
=
ºº. /
dr
ºº0 2
[
ºº2 3
$str
ºº3 B
]
ººB C
.
ººC D
ToString
ººD L
(
ººL M
)
ººM N
}
ΩΩ 
;
ΩΩ 
}
ææ 
}
øø 
}
¿¿ 
}
¡¡ 
return
¬¬ 
cliente
¬¬ 
;
¬¬ 
}
√√ 	
public
≈≈ 
async
≈≈ 
Task
≈≈ 
<
≈≈ 
Cliente
≈≈ !
>
≈≈! "
ObtenerPorCedula
≈≈# 3
(
≈≈3 4
string
≈≈4 :
cedula
≈≈; A
)
≈≈A B
{
∆∆ 	
Cliente
«« 
cliente
«« 
=
«« 
null
«« "
;
««" #
if
   
(
   
string
   
.
   
IsNullOrEmpty
   $
(
  $ %
cedula
  % +
)
  + ,
)
  , -
{
ÀÀ 
throw
ÃÃ 
new
ÃÃ 
ArgumentException
ÃÃ +
(
ÃÃ+ ,
$str
ÃÃ, L
)
ÃÃL M
;
ÃÃM N
}
ÕÕ 
using
œœ 
(
œœ 
var
œœ 
conexion
œœ 
=
œœ  !
new
œœ" %
SqlConnection
œœ& 3
(
œœ3 4
con
œœ4 7
.
œœ7 8
	CadenaSQL
œœ8 A
)
œœA B
)
œœB C
{
–– 
await
—— 
conexion
—— 
.
—— 
	OpenAsync
—— (
(
——( )
)
——) *
;
——* +
using
”” 
(
”” 

SqlCommand
”” !
cmd
””" %
=
””& '
new
””( +

SqlCommand
””, 6
(
””6 7
$str
””7 J
,
””J K
conexion
””L T
)
””T U
)
””U V
{
‘‘ 
cmd
’’ 
.
’’ 
CommandType
’’ #
=
’’$ %
CommandType
’’& 1
.
’’1 2
StoredProcedure
’’2 A
;
’’A B
cmd
ÿÿ 
.
ÿÿ 

Parameters
ÿÿ "
.
ÿÿ" #
AddWithValue
ÿÿ# /
(
ÿÿ/ 0
$str
ÿÿ0 ?
,
ÿÿ? @
cedula
ÿÿA G
??
ÿÿH J
string
ÿÿK Q
.
ÿÿQ R
Empty
ÿÿR W
)
ÿÿW X
;
ÿÿX Y
using
⁄⁄ 
(
⁄⁄ 
var
⁄⁄ 
dr
⁄⁄ !
=
⁄⁄" #
await
⁄⁄$ )
cmd
⁄⁄* -
.
⁄⁄- . 
ExecuteReaderAsync
⁄⁄. @
(
⁄⁄@ A
)
⁄⁄A B
)
⁄⁄B C
{
€€ 
if
‹‹ 
(
‹‹ 
await
‹‹ !
dr
‹‹" $
.
‹‹$ %
	ReadAsync
‹‹% .
(
‹‹. /
)
‹‹/ 0
)
‹‹0 1
{
›› 
cliente
ﬁﬁ #
=
ﬁﬁ$ %
new
ﬁﬁ& )
Cliente
ﬁﬁ* 1
(
ﬁﬁ1 2
)
ﬁﬁ2 3
{
ﬂﬂ 
	IdCliente
‡‡  )
=
‡‡* +
Convert
‡‡, 3
.
‡‡3 4
ToInt32
‡‡4 ;
(
‡‡; <
dr
‡‡< >
[
‡‡> ?
$str
‡‡? J
]
‡‡J K
)
‡‡K L
,
‡‡L M
NroDocumento
··  ,
=
··- .
dr
··/ 1
[
··1 2
$str
··2 @
]
··@ A
.
··A B
ToString
··B J
(
··J K
)
··K L
,
··L M
Nombre
‚‚  &
=
‚‚' (
dr
‚‚) +
[
‚‚+ ,
$str
‚‚, 4
]
‚‚4 5
.
‚‚5 6
ToString
‚‚6 >
(
‚‚> ?
)
‚‚? @
,
‚‚@ A
Apellido
„„  (
=
„„) *
dr
„„+ -
[
„„- .
$str
„„. 8
]
„„8 9
.
„„9 :
ToString
„„: B
(
„„B C
)
„„C D
,
„„D E
Correo
‰‰  &
=
‰‰' (
dr
‰‰) +
[
‰‰+ ,
$str
‰‰, 4
]
‰‰4 5
.
‰‰5 6
ToString
‰‰6 >
(
‰‰> ?
)
‰‰? @
,
‰‰@ A
Telefono
ÂÂ  (
=
ÂÂ) *
dr
ÂÂ+ -
[
ÂÂ- .
$str
ÂÂ. 8
]
ÂÂ8 9
.
ÂÂ9 :
ToString
ÂÂ: B
(
ÂÂB C
)
ÂÂC D
,
ÂÂD E
FechaCreacion
ÊÊ  -
=
ÊÊ. /
dr
ÊÊ0 2
[
ÊÊ2 3
$str
ÊÊ3 B
]
ÊÊB C
.
ÊÊC D
ToString
ÊÊD L
(
ÊÊL M
)
ÊÊM N
}
ÁÁ 
;
ÁÁ 
}
ËË 
}
ÈÈ 
}
ÍÍ 
}
ÎÎ 
return
ÏÏ 
cliente
ÏÏ 
;
ÏÏ 
}
ÌÌ 	
public
ÔÔ 
async
ÔÔ 
Task
ÔÔ 
<
ÔÔ 
string
ÔÔ  
>
ÔÔ  !
	Depositar
ÔÔ" +
(
ÔÔ+ ,
int
ÔÔ, /
	idCliente
ÔÔ0 9
,
ÔÔ9 :
decimal
ÔÔ; B
monto
ÔÔC H
)
ÔÔH I
{
 	
string
ÒÒ 
	respuesta
ÒÒ 
=
ÒÒ 
$str
ÒÒ !
;
ÒÒ! "
using
ÚÚ 
(
ÚÚ 
var
ÚÚ 
conexion
ÚÚ 
=
ÚÚ  !
new
ÚÚ" %
SqlConnection
ÚÚ& 3
(
ÚÚ3 4
con
ÚÚ4 7
.
ÚÚ7 8
	CadenaSQL
ÚÚ8 A
)
ÚÚA B
)
ÚÚB C
{
ÛÛ 
await
ÙÙ 
conexion
ÙÙ 
.
ÙÙ 
	OpenAsync
ÙÙ (
(
ÙÙ( )
)
ÙÙ) *
;
ÙÙ* +

SqlCommand
ıı 
cmd
ıı 
=
ıı  
new
ıı! $

SqlCommand
ıı% /
(
ıı/ 0
$str
ıı0 D
,
ııD E
conexion
ııF N
)
ııN O
;
ııO P
cmd
ˆˆ 
.
ˆˆ 

Parameters
ˆˆ 
.
ˆˆ 
AddWithValue
ˆˆ +
(
ˆˆ+ ,
$str
ˆˆ, 8
,
ˆˆ8 9
	idCliente
ˆˆ: C
)
ˆˆC D
;
ˆˆD E
cmd
˜˜ 
.
˜˜ 

Parameters
˜˜ 
.
˜˜ 
AddWithValue
˜˜ +
(
˜˜+ ,
$str
˜˜, 4
,
˜˜4 5
monto
˜˜6 ;
)
˜˜; <
;
˜˜< =
cmd
¯¯ 
.
¯¯ 

Parameters
¯¯ 
.
¯¯ 
Add
¯¯ "
(
¯¯" #
$str
¯¯# .
,
¯¯. /
	SqlDbType
¯¯0 9
.
¯¯9 :
VarChar
¯¯: A
,
¯¯A B
$num
¯¯C F
)
¯¯F G
.
¯¯G H
	Direction
¯¯H Q
=
¯¯R S 
ParameterDirection
¯¯T f
.
¯¯f g
Output
¯¯g m
;
¯¯m n
cmd
˘˘ 
.
˘˘ 
CommandType
˘˘ 
=
˘˘  !
CommandType
˘˘" -
.
˘˘- .
StoredProcedure
˘˘. =
;
˘˘= >
try
˚˚ 
{
¸¸ 
await
˝˝ 
cmd
˝˝ 
.
˝˝ "
ExecuteNonQueryAsync
˝˝ 2
(
˝˝2 3
)
˝˝3 4
;
˝˝4 5
	respuesta
˛˛ 
=
˛˛ 
Convert
˛˛  '
.
˛˛' (
ToString
˛˛( 0
(
˛˛0 1
cmd
˛˛1 4
.
˛˛4 5

Parameters
˛˛5 ?
[
˛˛? @
$str
˛˛@ K
]
˛˛K L
.
˛˛L M
Value
˛˛M R
)
˛˛R S
!
˛˛S T
;
˛˛T U
}
ˇˇ 
catch
ÄÄ 
{
ÅÅ 
	respuesta
ÇÇ 
=
ÇÇ 
$str
ÇÇ  3
;
ÇÇ3 4
}
ÉÉ 
}
ÑÑ 
return
ÖÖ 
	respuesta
ÖÖ 
;
ÖÖ 
}
ÜÜ 	
}
áá 
}àà Ã
YC:\Users\USUARIO\Desktop\DesarrolloSeguro2\SistemaPrestamo\Prestamo.Data\AuditoriaData.cs
	namespace 	
Prestamo
 
. 
Data 
{ 
public 

class 
AuditoriaData 
{ 
private 
readonly 
ConnectionStrings *
_connectionStrings+ =
;= >
public 
AuditoriaData 
( 
IOptions %
<% &
ConnectionStrings& 7
>7 8
options9 @
)@ A
{ 	
_connectionStrings 
=  
options! (
.( )
Value) .
;. /
} 	
public 
async 
Task 
< 
string  
>  !
Insertar" *
(* +
	Auditoria+ 4
log5 8
)8 9
{ 	
string 
	respuesta 
= 
$str !
;! "
using 
( 
var 
conexion 
=  !
new" %
SqlConnection& 3
(3 4
_connectionStrings4 F
.F G
	CadenaSQLG P
)P Q
)Q R
{ 
await 
conexion 
. 
	OpenAsync (
(( )
)) *
;* +

SqlCommand 
cmd 
=  
new! $

SqlCommand% /
(/ 0
$str0 F
,F G
conexionH P
)P Q
;Q R
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 6
,6 7
log8 ;
.; <
Usuario< C
)C D
;D E
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 5
,5 6
log7 :
.: ;
Accion; A
)A B
;B C
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 4
,4 5
log6 9
.9 :
Fecha: ?
)? @
;@ A
cmd   
.   

Parameters   
.   
AddWithValue   +
(  + ,
$str  , 7
,  7 8
log  9 <
.  < =
Detalles  = E
)  E F
;  F G
cmd!! 
.!! 
CommandType!! 
=!!  !
CommandType!!" -
.!!- .
StoredProcedure!!. =
;!!= >
try## 
{$$ 
await%% 
cmd%% 
.%%  
ExecuteNonQueryAsync%% 2
(%%2 3
)%%3 4
;%%4 5
	respuesta&& 
=&& 
$str&&  >
;&&> ?
}'' 
catch(( 
{)) 
	respuesta** 
=** 
$str**  3
;**3 4
}++ 
},, 
return-- 
	respuesta-- 
;-- 
}.. 	
}// 
}00 